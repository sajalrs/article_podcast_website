{"ast":null,"code":"var _jsxFileName = \"/home/sajalrs/ReactProgramming/article_podcast_website/client/src/pages/Articles/Edit.js\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport LargeCard from \"../../components/Cards/LargeCard/LargeCard.js\";\nimport SidePanel from \"../../components/SidePanel/SidePanel.js\";\nimport Card from \"../../components/Cards/Card.js\";\nimport styles from \"./Edit.module.css\";\nimport Header from \"../../components/Header/Header\";\nimport Footer from \"../../components/Footer/Footer\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport TextEditor from \"../../components/TextEditor/TextEditor\";\nimport { Value } from \"slate\";\nconst initialValue = {\n  document: {\n    nodes: [{\n      object: \"block\",\n      type: \"paragraph\",\n      nodes: [{\n        object: \"text\",\n        leaves: [{\n          text: \"This text is editable\"\n        }]\n      }]\n    }]\n  }\n};\n\nconst Edit = props => {\n  const [textEditorValue, setTextEditorValue] = useState(Value.fromJSON(initialValue));\n  const [formData, setFormData] = useState({\n    title: \"\",\n    author: \"\",\n    date: \"\",\n    image: {}\n  });\n  const {\n    id\n  } = useParams();\n  const history = useHistory();\n  const [sidePanelFixed, setSidePanelFix] = useState(false);\n  const headerBoxRef = useRef();\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, []);\n  useEffect(() => {\n    const fixNavbar = e => {\n      if (window.scrollY > headerBoxRef.current.clientHeight - 66 - 35 + 644) {\n        setSidePanelFix(true);\n      } else {\n        setSidePanelFix(false);\n      }\n    };\n\n    window.addEventListener(\"scroll\", fixNavbar);\n    return () => {\n      window.removeEventListener(\"scroll\", fixNavbar);\n    };\n  }, [sidePanelFixed]);\n  const [article, setArticle] = useState({\n    id: {},\n    title: \"\",\n    author: \"\",\n    date: \"\",\n    image: {}\n  });\n  const largeCardRef = useRef();\n  useEffect(() => {\n    console.log(id);\n\n    const getArticle = async () => {\n      const response = await fetch(\"/articles?\" + id);\n      const body = await response.json();\n      if (response.status !== 200) throw Error(body.message);\n      return body;\n    };\n\n    getArticle().then(res => {\n      setArticle({\n        id: res._id,\n        title: res.title,\n        author: res.author,\n        date: res.date,\n        image: res.image\n      });\n      if (res.content) setTextEditorValue(Value.fromJSON(res.content));\n    });\n  }, []);\n  useEffect(() => {\n    console.log(\"Running this\");\n    setFormData({\n      title: article.title,\n      author: article.author,\n      date: article.date,\n      image: article.image\n    });\n  }, [article.title, article.author, article.author, article.date, article.image]);\n\n  const saveArticle = async () => {\n    const editedArticle = { ...article,\n      content: textEditorValue.toJSON()\n    };\n    const requestOptions = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(editedArticle)\n    };\n    const response = await fetch(`/articles/edit`, requestOptions);\n    const data = await response.json();\n    if (response.status !== 200) throw Error(data.message);\n  };\n\n  const getLinkFunction = linkType => {\n    switch (linkType) {\n      case Card.LinkType[\"video-youtube\"]:\n        return props.playVideo;\n\n      case Card.LinkType[\"article-internal\"]:\n        return articleLink => {\n          history.push(articleLink);\n        };\n\n      default:\n        break;\n    }\n  };\n\n  const renderOnceSidePanel = /*#__PURE__*/React.createElement(SidePanel, {\n    sideBarClicked: props.sideBarClicked,\n    setSideBarClicked: props.setSideBarClicked,\n    youtubeIds: props.youtubeIds,\n    getImageLink: props.getImageLink,\n    playVideo: props.playVideo,\n    getHyperLink: props.getHyperLink,\n    sidePanelFixed: sidePanelFixed,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 5\n    }\n  });\n\n  const handleSubmit = event => {\n    event.preventDefault(); // if(!(article.title === formData.title && article.image === formData.image && article.author === formData.author)){\n\n    setArticle({ ...article.id,\n      title: formData.title,\n      author: formData.author,\n      date: formData.date,\n      image: formData.image,\n      ...article.content\n    }); // } \n  };\n\n  const onTitleChange = event => {\n    setFormData({\n      title: event.target.value,\n      ...formData.author,\n      ...formData.date,\n      ...formData.image\n    });\n  };\n\n  const onAuthorChange = event => {\n    setFormData({ ...formData.title,\n      author: event.target.value,\n      ...formData.date,\n      ...formData.image\n    });\n  };\n\n  const onDateChange = event => {\n    setFormData({ ...formData.title,\n      ...formData.author,\n      date: event.target.value,\n      ...formData.image\n    });\n  };\n\n  const onImageChange = event => {\n    setFormData({ ...formData.title,\n      ...formData.author,\n      ...formData.date,\n      image: event.target.value\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"overarching\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"primary-color-background\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"Edit\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    ref: headerBoxRef,\n    sideBarClicked: props.sideBarClicked,\n    setSideBarClicked: props.setSideBarClicked,\n    navbarClicked: props.navbarClicked,\n    setNavbarClicked: props.setNavbarClicked,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"headline\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(LargeCard, {\n    title: article.title,\n    author: article.author,\n    date: article.date,\n    image: article.image,\n    onClick: () => {},\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"content-pane\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"main-pane\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 15\n    }\n  }, \"Title: \", /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: formData.title,\n    onChange: onTitleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 15\n    }\n  }, \"Author: \", /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: formData.author,\n    onChange: onAuthorChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 30\n    }\n  })), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 15\n    }\n  }, \"Date: \", /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: formData.date,\n    onChange: onDateChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 28\n    }\n  })), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 15\n    }\n  }, \"Image: \", /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: formData.image,\n    onChange: onImageChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"submit\",\n    value: \"Submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(TextEditor, {\n    value: textEditorValue,\n    setValue: setTextEditorValue,\n    onSave: saveArticle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"side-pane\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 11\n    }\n  }), sidePanelFixed ? /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: \"fixed\",\n      top: props.topOffset,\n      right: \"0px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 13\n    }\n  }, renderOnceSidePanel) : /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      marginTop: props.topOffset\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 13\n    }\n  }, renderOnceSidePanel)), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"footer-container\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 11\n    }\n  }))));\n};\n\nexport default Edit;","map":{"version":3,"sources":["/home/sajalrs/ReactProgramming/article_podcast_website/client/src/pages/Articles/Edit.js"],"names":["React","useState","useEffect","useRef","LargeCard","SidePanel","Card","styles","Header","Footer","useHistory","useParams","TextEditor","Value","initialValue","document","nodes","object","type","leaves","text","Edit","props","textEditorValue","setTextEditorValue","fromJSON","formData","setFormData","title","author","date","image","id","history","sidePanelFixed","setSidePanelFix","headerBoxRef","window","scrollTo","fixNavbar","e","scrollY","current","clientHeight","addEventListener","removeEventListener","article","setArticle","largeCardRef","console","log","getArticle","response","fetch","body","json","status","Error","message","then","res","_id","content","saveArticle","editedArticle","toJSON","requestOptions","method","headers","JSON","stringify","data","getLinkFunction","linkType","LinkType","playVideo","articleLink","push","renderOnceSidePanel","sideBarClicked","setSideBarClicked","youtubeIds","getImageLink","getHyperLink","handleSubmit","event","preventDefault","onTitleChange","target","value","onAuthorChange","onDateChange","onImageChange","navbarClicked","setNavbarClicked","position","top","topOffset","right","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport LargeCard from \"../../components/Cards/LargeCard/LargeCard.js\";\nimport SidePanel from \"../../components/SidePanel/SidePanel.js\";\nimport Card from \"../../components/Cards/Card.js\";\nimport styles from \"./Edit.module.css\";\nimport Header from \"../../components/Header/Header\";\nimport Footer from \"../../components/Footer/Footer\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport TextEditor from \"../../components/TextEditor/TextEditor\";\nimport { Value } from \"slate\";\n\nconst initialValue = {\n  document: {\n    nodes: [\n      {\n        object: \"block\",\n        type: \"paragraph\",\n        nodes: [\n          {\n            object: \"text\",\n            leaves: [\n              {\n                text: \"This text is editable\",\n              },\n            ],\n          },\n        ],\n      },\n    ],\n  },\n};\n\nconst Edit = (props) => {\n  const [textEditorValue, setTextEditorValue] = useState(\n    Value.fromJSON(initialValue)\n  );\n  const [formData, setFormData] = useState({\n    title: \"\",\n    author: \"\",\n    date: \"\",\n    image: {},\n  });\n  const { id } = useParams();\n  const history = useHistory();\n  const [sidePanelFixed, setSidePanelFix] = useState(false);\n  const headerBoxRef = useRef();\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, []);\n  useEffect(() => {\n    const fixNavbar = (e) => {\n      if (window.scrollY > headerBoxRef.current.clientHeight - 66 - 35 + 644) {\n        setSidePanelFix(true);\n      } else {\n        setSidePanelFix(false);\n      }\n    };\n\n    window.addEventListener(\"scroll\", fixNavbar);\n    return () => {\n      window.removeEventListener(\"scroll\", fixNavbar);\n    };\n  }, [sidePanelFixed]);\n\n  const [article, setArticle] = useState({\n    id: {},\n    title: \"\",\n    author: \"\",\n    date: \"\",\n    image: {},\n  });\n\n  const largeCardRef = useRef();\n  useEffect(() => {\n    console.log(id);\n    const getArticle = async () => {\n      const response = await fetch(\"/articles?\" + id);\n      const body = await response.json();\n      if (response.status !== 200) throw Error(body.message);\n\n      return body;\n    };\n\n    getArticle().then((res) => {\n      setArticle({\n        id: res._id,\n        title: res.title,\n        author: res.author,\n        date: res.date,\n        image: res.image,\n      });\n  \n      if (res.content) setTextEditorValue(Value.fromJSON(res.content));\n    });\n  }, []);\n\n  useEffect(() => {\n    console.log(\"Running this\")\n    setFormData({\n      title: article.title,\n    author: article.author,\n    date: article.date,\n    image: article.image,\n    })\n  }, [article.title, article.author, article.author, article.date, article.image])\n\n  const saveArticle = async () => {\n    const editedArticle = { ...article, content: textEditorValue.toJSON() };\n\n    const requestOptions = {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(editedArticle),\n    };\n\n    const response = await fetch(`/articles/edit`, requestOptions);\n    const data = await response.json();\n    if (response.status !== 200) throw Error(data.message);\n  };\n\n  const getLinkFunction = (linkType) => {\n    switch (linkType) {\n      case Card.LinkType[\"video-youtube\"]:\n        return props.playVideo;\n      case Card.LinkType[\"article-internal\"]:\n        return (articleLink) => {\n          history.push(articleLink);\n        };\n      default:\n        break;\n    }\n  };\n\n  const renderOnceSidePanel = (\n    <SidePanel\n      sideBarClicked={props.sideBarClicked}\n      setSideBarClicked={props.setSideBarClicked}\n      youtubeIds={props.youtubeIds}\n      getImageLink={props.getImageLink}\n      playVideo={props.playVideo}\n      getHyperLink={props.getHyperLink}\n      sidePanelFixed={sidePanelFixed}\n    />\n  );\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    // if(!(article.title === formData.title && article.image === formData.image && article.author === formData.author)){\n      setArticle({\n        ...article.id,\n        title: formData.title,\n        author: formData.author,\n        date: formData.date,\n        image: formData.image,\n        ...article.content\n      })\n    // } \n  };\n\n  const onTitleChange = (event) => {\n    setFormData({\n      title: event.target.value,\n      ...formData.author,\n      ...formData.date,\n      ...formData.image\n    }\n    )\n  }\n\n  const onAuthorChange = (event) => {\n    setFormData({\n      ...formData.title,\n      author: event.target.value,\n      ...formData.date,\n      ...formData.image\n    }\n    )\n  }\n\n  const onDateChange = (event) => {\n    setFormData({\n      ...formData.title,\n      ...formData.author,\n      date: event.target.value,\n      ...formData.image\n    }\n    )\n  }\n\n  \n  const onImageChange = (event) => {\n    setFormData({\n      ...formData.title,\n      ...formData.author,\n      ...formData.date,\n      image: event.target.value\n    }\n    )\n  }\n\n  return (\n    <div className={styles[\"overarching\"]}>\n      <div className={styles[\"primary-color-background\"]}></div>\n      <div className={styles[\"Edit\"]}>\n        <Header\n          ref={headerBoxRef}\n          sideBarClicked={props.sideBarClicked}\n          setSideBarClicked={props.setSideBarClicked}\n          navbarClicked={props.navbarClicked}\n          setNavbarClicked={props.setNavbarClicked}\n        />\n        <div className={styles[\"headline\"]}>\n          <LargeCard\n            title={article.title}\n            author={article.author}\n            date={article.date}\n            image={article.image}\n            onClick={() => {}}\n          />\n        </div>\n        <div className={styles[\"content-pane\"]}>\n          <div className={styles[\"main-pane\"]}>\n            <form onSubmit={handleSubmit}>\n              <label>Title: <input type=\"text\" value={formData.title} onChange={onTitleChange} /></label>\n              <label>Author: <input type=\"text\" value={formData.author} onChange={onAuthorChange} /></label>\n              <label>Date: <input type=\"text\" value={formData.date} onChange={onDateChange} /></label>\n              <label>Image: <input type=\"text\" value={formData.image} onChange={onImageChange} /></label>\n              <input type=\"submit\" value=\"Submit\"/>\n            </form>\n            <TextEditor\n              value={textEditorValue}\n              setValue={setTextEditorValue}\n              onSave={saveArticle}\n            />\n          </div>\n\n          <div className={styles[\"side-pane\"]}></div>\n          {sidePanelFixed ? (\n            <div\n              style={{ position: \"fixed\", top: props.topOffset, right: \"0px\" }}\n            >\n              {/* <div style={{ position: \"fixed\", top: \"103.5px\", right: \"0px\"}}> */}\n              {renderOnceSidePanel}\n            </div>\n          ) : (\n            <div style={{ marginTop: props.topOffset }}>\n              {renderOnceSidePanel}\n            </div>\n          )}\n        </div>\n\n        <div className={styles[\"footer-container\"]}>\n          <Footer />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Edit;\n"]},"metadata":{},"sourceType":"module"}