{"ast":null,"code":"var _jsxFileName = \"/home/sajalrs/ReactProgramming/article_podcast_website/client/src/pages/Articles/Edit.js\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport LargeCard from \"../../components/Cards/LargeCard/LargeCard.js\";\nimport SidePanel from \"../../components/SidePanel/SidePanel.js\";\nimport Card from \"../../components/Cards/Card.js\";\nimport styles from \"./Edit.module.css\";\nimport Header from \"../../components/Header/Header\";\nimport Footer from \"../../components/Footer/Footer\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport TextEditor from '../../components/TextEditor/TextEditor';\nimport { Value } from \"slate\";\nimport Html from 'slate-html-serializer';\nconst initialValue = {\n  document: {\n    nodes: [{\n      object: \"block\",\n      type: \"paragraph\",\n      nodes: [{\n        object: \"text\",\n        leaves: [{\n          text: \"This text is editable\"\n        }]\n      }]\n    }]\n  }\n};\n\nconst Edit = props => {\n  const [textEditorValue, setTextEditorValue] = useState(Value.fromJSON(initialValue));\n  const {\n    id\n  } = useParams();\n  const history = useHistory();\n  const [sidePanelFixed, setSidePanelFix] = useState(false);\n  const headerBoxRef = useRef();\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, []);\n  useEffect(() => {\n    const fixNavbar = e => {\n      if (window.scrollY > headerBoxRef.current.clientHeight - 66 - 35 + 644) {\n        setSidePanelFix(true);\n      } else {\n        setSidePanelFix(false);\n      }\n    };\n\n    window.addEventListener(\"scroll\", fixNavbar);\n    return () => {\n      window.removeEventListener(\"scroll\", fixNavbar);\n    };\n  }, [sidePanelFixed]);\n  const [article, setArticle] = useState({\n    id: {},\n    title: \"\",\n    author: \"\",\n    date: \"\",\n    image: {}\n  });\n  const largeCardRef = useRef();\n  useEffect(() => {\n    console.log(id);\n\n    const getArticle = async () => {\n      const response = await fetch(\"/articles?\" + id);\n      const body = await response.json();\n      if (response.status !== 200) throw Error(body.message);\n      return body;\n    };\n\n    getArticle().then(res => {\n      setArticle({\n        id: res._id,\n        title: res.title,\n        author: res.author,\n        date: res.date,\n        image: res.image\n      });\n      if (res.content) setTextEditorValue(Value.fromJSON(res.content));\n    });\n  }, []);\n\n  const saveArticle = async () => {\n    const editedArticle = { ...article,\n      content: textEditorValue.toJSON()\n    };\n    const requestOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(editedArticle)\n    };\n    const response = await fetch(`/articles/edit`, requestOptions);\n    const data = await response.json();\n    if (response.status !== 200) throw Error(data.message);\n  };\n\n  const getLinkFunction = linkType => {\n    switch (linkType) {\n      case Card.LinkType[\"video-youtube\"]:\n        return props.playVideo;\n\n      case Card.LinkType[\"article-internal\"]:\n        return articleLink => {\n          history.push(articleLink);\n        };\n\n      default:\n        break;\n    }\n  };\n\n  const BLOCK_TAGS = {\n    p: 'paragraph',\n    blockquote: 'block-quote',\n    ul: `bulleted-list`,\n    h1: `heading-one`,\n    h2: `heading-two`,\n    li: `list-item`,\n    ol: `numbered-list`,\n    img: `image`\n  }; // Add a dictionary of mark tags.\n\n  const MARK_TAGS = {\n    em: 'italic',\n    strong: 'bold',\n    u: 'underline',\n    code: `code`\n  };\n  const rules = [{\n    deserialize(el, next) {\n      const type = BLOCK_TAGS[el.tagName.toLowerCase()];\n\n      if (type) {\n        return {\n          object: 'block',\n          type: type,\n          data: {\n            className: el.getAttribute('class')\n          },\n          nodes: next(el.childNodes)\n        };\n      }\n    },\n\n    serialize(obj, children) {\n      if (obj.object == 'block') {\n        switch (obj.type) {\n          case 'paragraph':\n            return /*#__PURE__*/React.createElement(\"div\", {\n              className: styles[\"main-pane-item\"],\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 23\n              }\n            }, /*#__PURE__*/React.createElement(\"p\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 65\n              }\n            }, children));\n\n          case \"block-quote\":\n            return /*#__PURE__*/React.createElement(\"div\", {\n              className: styles[\"main-pane-item\"],\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 25\n              }\n            }, /*#__PURE__*/React.createElement(\"blockquote\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 67\n              }\n            }, children));\n\n          case \"bulleted-list\":\n            return /*#__PURE__*/React.createElement(\"div\", {\n              className: styles[\"main-pane-item\"],\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 24\n              }\n            }, /*#__PURE__*/React.createElement(\"ul\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 66\n              }\n            }, children));\n\n          case \"heading-one\":\n            return /*#__PURE__*/React.createElement(\"div\", {\n              className: styles[\"main-pane-item\"],\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 24\n              }\n            }, /*#__PURE__*/React.createElement(\"h1\", {\n              className: styles[\"heading\"],\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 66\n              }\n            }, children));\n\n          case \"heading-two\":\n            return /*#__PURE__*/React.createElement(\"div\", {\n              className: styles[\"main-pane-item\"],\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 171,\n                columnNumber: 24\n              }\n            }, /*#__PURE__*/React.createElement(\"h2\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 171,\n                columnNumber: 66\n              }\n            }, children));\n\n          case \"list-item\":\n            return /*#__PURE__*/React.createElement(\"div\", {\n              className: styles[\"main-pane-item\"],\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 24\n              }\n            }, /*#__PURE__*/React.createElement(\"li\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 66\n              }\n            }, children));\n\n          case \"numbered-list\":\n            return /*#__PURE__*/React.createElement(\"div\", {\n              className: styles[\"main-pane-item\"],\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 175,\n                columnNumber: 24\n              }\n            }, /*#__PURE__*/React.createElement(\"ol\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 175,\n                columnNumber: 66\n              }\n            }, children));\n\n          case \"image\":\n            {\n              const src = obj.data['src'];\n              return /*#__PURE__*/React.createElement(\"div\", {\n                className: styles[\"main-pane-item\"],\n                __self: this,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 179,\n                  columnNumber: 19\n                }\n              }, /*#__PURE__*/React.createElement(\"figure\", {\n                className: styles[\"image-container\"],\n                __self: this,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 180,\n                  columnNumber: 19\n                }\n              }, /*#__PURE__*/React.createElement(\"img\", {\n                src: src,\n                __self: this,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 181,\n                  columnNumber: 19\n                }\n              })));\n            }\n        }\n      }\n    }\n\n  }, // Add a new rule that handles marks...\n  {\n    deserialize(el, next) {\n      const type = MARK_TAGS[el.tagName.toLowerCase()];\n\n      if (type) {\n        return {\n          object: 'mark',\n          type: type,\n          nodes: next(el.childNodes)\n        };\n      }\n    },\n\n    serialize(obj, children) {\n      if (obj.object == 'mark') {\n        switch (obj.type) {\n          case 'bold':\n            return /*#__PURE__*/React.createElement(\"strong\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 208,\n                columnNumber: 22\n              }\n            }, children);\n\n          case 'italic':\n            return /*#__PURE__*/React.createElement(\"em\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 22\n              }\n            }, children);\n\n          case 'code':\n            return /*#__PURE__*/React.createElement(\"code\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 212,\n                columnNumber: 22\n              }\n            }, children);\n\n          case 'underline':\n            return /*#__PURE__*/React.createElement(\"u\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 214,\n                columnNumber: 22\n              }\n            }, children);\n        }\n      }\n    }\n\n  }];\n  const html = new Html({\n    rules\n  });\n  const renderOnceSidePanel = /*#__PURE__*/React.createElement(SidePanel, {\n    sideBarClicked: props.sideBarClicked,\n    setSideBarClicked: props.setSideBarClicked,\n    youtubeIds: props.youtubeIds,\n    getImageLink: props.getImageLink,\n    playVideo: props.playVideo,\n    getHyperLink: props.getHyperLink,\n    sidePanelFixed: sidePanelFixed,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 5\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"overarching\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"primary-color-background\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"Edit\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    ref: headerBoxRef,\n    sideBarClicked: props.sideBarClicked,\n    setSideBarClicked: props.setSideBarClicked,\n    navbarClicked: props.navbarClicked,\n    setNavbarClicked: props.setNavbarClicked,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"headline\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(LargeCard, {\n    title: article.title,\n    author: article.author,\n    date: article.date,\n    image: article.image,\n    onClick: () => {},\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"content-pane\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"main-pane\"],\n    dangerouslySetInnerHTML: {\n      __html: html.serialize(res.content)\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"side-pane\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(TextEditor, {\n    value: textEditorValue,\n    setValue: setTextEditorValue,\n    onSave: saveArticle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 11\n    }\n  })), sidePanelFixed ? /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: \"fixed\",\n      top: props.topOffset,\n      right: \"0px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 13\n    }\n  }, renderOnceSidePanel) : /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      marginTop: props.topOffset\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 13\n    }\n  }, renderOnceSidePanel)), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"footer-container\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 11\n    }\n  }))));\n};\n\nexport default Edit;","map":{"version":3,"sources":["/home/sajalrs/ReactProgramming/article_podcast_website/client/src/pages/Articles/Edit.js"],"names":["React","useState","useEffect","useRef","LargeCard","SidePanel","Card","styles","Header","Footer","useHistory","useParams","TextEditor","Value","Html","initialValue","document","nodes","object","type","leaves","text","Edit","props","textEditorValue","setTextEditorValue","fromJSON","id","history","sidePanelFixed","setSidePanelFix","headerBoxRef","window","scrollTo","fixNavbar","e","scrollY","current","clientHeight","addEventListener","removeEventListener","article","setArticle","title","author","date","image","largeCardRef","console","log","getArticle","response","fetch","body","json","status","Error","message","then","res","_id","content","saveArticle","editedArticle","toJSON","requestOptions","method","headers","JSON","stringify","data","getLinkFunction","linkType","LinkType","playVideo","articleLink","push","BLOCK_TAGS","p","blockquote","ul","h1","h2","li","ol","img","MARK_TAGS","em","strong","u","code","rules","deserialize","el","next","tagName","toLowerCase","className","getAttribute","childNodes","serialize","obj","children","src","html","renderOnceSidePanel","sideBarClicked","setSideBarClicked","youtubeIds","getImageLink","getHyperLink","navbarClicked","setNavbarClicked","__html","position","top","topOffset","right","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport LargeCard from \"../../components/Cards/LargeCard/LargeCard.js\";\nimport SidePanel from \"../../components/SidePanel/SidePanel.js\";\nimport Card from \"../../components/Cards/Card.js\";\nimport styles from \"./Edit.module.css\";\nimport Header from \"../../components/Header/Header\";\nimport Footer from \"../../components/Footer/Footer\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport TextEditor from '../../components/TextEditor/TextEditor'\nimport {Value } from \"slate\";\nimport Html from 'slate-html-serializer'\nconst initialValue = {\n  document: {\n    nodes: [\n      {\n        object: \"block\",\n        type: \"paragraph\",\n        nodes: [\n          {\n            object: \"text\",\n            leaves: [\n              {\n                text: \"This text is editable\",\n              },\n            ],\n          },\n        ],\n      },\n    ],\n  },\n};\n\nconst Edit = (props) => {\n  const [textEditorValue, setTextEditorValue] = useState(Value.fromJSON(initialValue));\n  const { id } = useParams();\n  const history = useHistory();\n  const [sidePanelFixed, setSidePanelFix] = useState(false);\n  const headerBoxRef = useRef();\n  \n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, []);\n  useEffect(() => {\n    const fixNavbar = (e) => {\n      if (window.scrollY > headerBoxRef.current.clientHeight - 66 - 35 + 644) {\n        setSidePanelFix(true);\n      } else {\n        setSidePanelFix(false);\n      }\n    };\n\n    window.addEventListener(\"scroll\", fixNavbar);\n    return () => {\n      window.removeEventListener(\"scroll\", fixNavbar);\n    };\n  }, [sidePanelFixed]);\n\n  const [article, setArticle] = useState({\n    id: {},\n    title: \"\",\n    author: \"\",\n    date: \"\",\n    image: {}\n  });\n\n  const largeCardRef = useRef();\n  useEffect(() => {\n    console.log(id);\n    const getArticle = async () => {\n      const response = await fetch(\"/articles?\" + id);\n      const body = await response.json();\n      if (response.status !== 200) throw Error(body.message);\n\n      return body;\n    };\n\n    getArticle().then((res) => {\n      setArticle({\n        id: res._id,\n        title: res.title,\n        author: res.author,\n        date: res.date,\n        image: res.image,\n      });\n     \n      if(res.content) setTextEditorValue(Value.fromJSON(res.content));\n        \n      \n      \n      \n    });\n  },[]);\n\n\n \n  const saveArticle = async () => {\n    const editedArticle = {...article, content: textEditorValue.toJSON()};\n    \n    const requestOptions = {\n      method: 'POST',\n      headers: {'Content-Type': 'application/json'},\n      body: JSON.stringify(editedArticle)\n    };\n\n    const response = await fetch(`/articles/edit`, requestOptions);\n    const data = await response.json();\n    if (response.status !== 200) throw Error(data.message);\n  \n\n  }\n\n  const getLinkFunction = (linkType) => {\n    switch (linkType) {\n      case Card.LinkType[\"video-youtube\"]:\n        return props.playVideo;\n      case Card.LinkType[\"article-internal\"]:\n        return (articleLink) => {\n          history.push(articleLink);\n        };\n      default:\n        break;\n    }\n  };\n\n  const BLOCK_TAGS = {\n    p: 'paragraph',\n    blockquote: 'block-quote',\n    ul: `bulleted-list`,\n    h1: `heading-one`,\n    h2: `heading-two`,\n    li: `list-item`,\n    ol: `numbered-list`,\n    img: `image`\n  }\n  \n  // Add a dictionary of mark tags.\n  const MARK_TAGS = {\n    em: 'italic',\n    strong: 'bold',\n    u: 'underline',\n    code: `code`\n  }\n  \n  const rules = [\n    {\n      deserialize(el, next) {\n        const type = BLOCK_TAGS[el.tagName.toLowerCase()]\n        if (type) {\n          return {\n            object: 'block',\n            type: type,\n            data: {\n              className: el.getAttribute('class'),\n            },\n            nodes: next(el.childNodes),\n          }\n        }\n      },\n      serialize(obj, children) {\n        if (obj.object == 'block') {\n          switch (obj.type) {\n            case 'paragraph':\n              return  <div className={styles[\"main-pane-item\"]}><p>{children}</p></div>\n              case \"block-quote\":\n                return  <div className={styles[\"main-pane-item\"]}><blockquote>{children}</blockquote></div>;\n              case \"bulleted-list\":\n                return <div className={styles[\"main-pane-item\"]}><ul>{children}</ul></div>;\n              case \"heading-one\":\n                return <div className={styles[\"main-pane-item\"]}><h1 className={styles[\"heading\"]}>{children}</h1></div>;\n              case \"heading-two\":\n                return <div className={styles[\"main-pane-item\"]}><h2>{children}</h2></div>;\n              case \"list-item\":\n                return <div className={styles[\"main-pane-item\"]}><li>{children}</li></div>;\n              case \"numbered-list\":\n                return <div className={styles[\"main-pane-item\"]}><ol>{children}</ol></div>;\n              case \"image\": {\n                const src = obj.data['src']\n                return (\n                  <div className={styles[\"main-pane-item\"]}>\n                  <figure className={styles[\"image-container\"]}>\n                  <img\n                    src={src}\n                  />\n                  </figure>\n                  </div>\n                )\n              }\n          }\n        }\n      },\n    },\n    // Add a new rule that handles marks...\n    {\n      deserialize(el, next) {\n        const type = MARK_TAGS[el.tagName.toLowerCase()]\n        if (type) {\n          return {\n            object: 'mark',\n            type: type,\n            nodes: next(el.childNodes),\n          }\n        }\n      },\n      serialize(obj, children) {\n        if (obj.object == 'mark') {\n          switch (obj.type) {\n            case 'bold':\n              return <strong>{children}</strong>\n            case 'italic':\n              return <em>{children}</em>\n            case 'code':\n              return <code>{children}</code>\n            case 'underline':\n              return <u>{children}</u>\n          }\n        }\n      },\n    },\n  ]\n\n  const html = new Html({rules})\n\n  const renderOnceSidePanel = (\n    <SidePanel\n      sideBarClicked={props.sideBarClicked}\n      setSideBarClicked={props.setSideBarClicked}\n      youtubeIds={props.youtubeIds}\n      getImageLink={props.getImageLink}\n      playVideo={props.playVideo}\n      getHyperLink={props.getHyperLink}\n      sidePanelFixed={sidePanelFixed}\n    />\n  );\n\n  return (\n    <div className={styles[\"overarching\"]}>\n      <div className={styles[\"primary-color-background\"]}></div>\n      <div className={styles[\"Edit\"]}>\n        <Header\n          ref={headerBoxRef}\n          sideBarClicked={props.sideBarClicked}\n          setSideBarClicked={props.setSideBarClicked}\n          navbarClicked={props.navbarClicked}\n          setNavbarClicked={props.setNavbarClicked}\n        />\n        <div className={styles[\"headline\"]}>\n          <LargeCard\n            title={article.title}\n            author={article.author}\n            date={article.date}\n            image={article.image}\n            onClick={() => {}}\n          />\n        </div>\n        <div className={styles[\"content-pane\"]}>\n          <div className={styles[\"main-pane\"]}\n           dangerouslySetInnerHTML={{__html:  html.serialize(res.content)}}>\n            \n          </div>\n\n          <div className={styles[\"side-pane\"]}>\n          <TextEditor value={textEditorValue} setValue={setTextEditorValue} onSave={saveArticle}/>\n          </div>\n          {sidePanelFixed ? (\n            <div\n              style={{ position: \"fixed\", top: props.topOffset, right: \"0px\" }}\n            >\n              {/* <div style={{ position: \"fixed\", top: \"103.5px\", right: \"0px\"}}> */}\n              {renderOnceSidePanel}\n            </div>\n          ) : (\n            <div style={{ marginTop: props.topOffset }}>\n              {renderOnceSidePanel}\n            </div>\n          )}\n        </div>\n\n        <div className={styles[\"footer-container\"]}>\n          <Footer />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Edit;\n"]},"metadata":{},"sourceType":"module"}