{"ast":null,"code":"var _jsxFileName = \"/home/sajalrs/ReactProgramming/article_podcast_website/client/src/components/TextEditor/TextEditor.js\";\nimport React, { useState, useRef } from \"react\";\nimport { Editor } from \"slate-react\";\nimport { Value } from \"slate\";\nimport styles from \"./TextEditor.module.css\";\nimport FormatToolbar from \"./FormatToolbar\";\nimport { isKeyHotkey } from \"is-hotkey\";\nimport imageExtensions from 'image-extensions';\nimport isUrl from 'is-url';\nconst initialValue = Value.fromJSON({\n  document: {\n    nodes: [{\n      object: \"block\",\n      type: \"paragraph\",\n      nodes: [{\n        object: \"text\",\n        leaves: [{\n          text: \"My first paragraph\"\n        }]\n      }]\n    }]\n  }\n});\n\nconst TextEditor = () => {\n  const [value, setValue] = useState(initialValue);\n  const ref = useRef();\n  const DEFAULT_NODE = 'paragraph';\n  const isBoldHotkey = isKeyHotkey(\"mod+b\");\n  const isItalicHotkey = isKeyHotkey(\"mod+i\");\n  const isUnderlinedHotkey = isKeyHotkey(\"mod+u\");\n  const isCodeHotkey = isKeyHotkey(\"mod+`\");\n\n  const hasMark = type => {\n    return value.activeMarks.some(node => node.type === type);\n  };\n\n  const hasBlock = type => {\n    return value.blocks.some(node => node.type === type);\n  };\n\n  const isImage = url => {\n    return imageExtensions.includes(getExtension(url));\n  };\n\n  const getExtension = url => {\n    return new URL(url).pathname.split('.').pop;\n  };\n\n  const insertImage = (editor, src, target) => {\n    if (target) {\n      editor.select(target);\n    }\n\n    editor.insertBlock({\n      type: 'image',\n      data: {\n        src\n      }\n    });\n  };\n\n  const schema = {\n    document: {\n      last: {\n        type: 'paragraph'\n      },\n      normalize: (editor, {\n        code,\n        node,\n        child\n      }) => {\n        switch (code) {\n          case 'last_child_type_invalid':\n            {\n              const paragraph = Block.create('paragraph');\n              return editor.insertNodeByKey(node.key, node.nodes.size, paragraph);\n            }\n        }\n      }\n    },\n    blocks: {\n      image: {\n        isVoid: true\n      }\n    }\n  };\n\n  const renderMarkButton = (type, icon) => {\n    const isActive = hasMark(type);\n    return /*#__PURE__*/React.createElement(\"button\", {\n      active: isActive,\n      onPointerDown: event => onClickMark(event, type),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: icon,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }\n    }));\n  };\n\n  const renderImageButton = icon => {\n    return /*#__PURE__*/React.createElement(\"button\", {\n      onPointerDown: onClickImage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: icon,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }\n    }));\n  };\n\n  const renderBlockButton = (type, icon) => {\n    let isActive = hasBlock(type);\n\n    if ([\"numbered-list\", \"bulleted-list\"].includes(type)) {\n      const {\n        document,\n        blocks\n      } = value;\n\n      if (blocks.size > 0) {\n        const parent = document.getParent(blocks.first().key);\n        isActive = hasBlock(\"list-item\") && parent && parent.type === type;\n      }\n    }\n\n    return /*#__PURE__*/React.createElement(\"button\", {\n      active: isActive,\n      onPointerDown: event => onClickBlock(event, type),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: icon,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }\n    }));\n  };\n\n  const renderBlock = (props, editor, next) => {\n    const {\n      attributes,\n      children,\n      node\n    } = props;\n\n    switch (node.type) {\n      case \"block-quote\":\n        return /*#__PURE__*/React.createElement(\"blockquote\", Object.assign({}, attributes, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 16\n          }\n        }), children);\n\n      case \"bulleted-list\":\n        return /*#__PURE__*/React.createElement(\"ul\", Object.assign({}, attributes, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 16\n          }\n        }), children);\n\n      case \"heading-one\":\n        return /*#__PURE__*/React.createElement(\"h1\", Object.assign({}, attributes, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 16\n          }\n        }), children);\n\n      case \"heading-two\":\n        return /*#__PURE__*/React.createElement(\"h2\", Object.assign({}, attributes, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 16\n          }\n        }), children);\n\n      case \"list-item\":\n        return /*#__PURE__*/React.createElement(\"li\", Object.assign({}, attributes, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 16\n          }\n        }), children);\n\n      case \"numbered-list\":\n        return /*#__PURE__*/React.createElement(\"ol\", Object.assign({}, attributes, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 16\n          }\n        }), children);\n\n      case \"image\":\n        {\n          const src = node.data.get('src');\n          return /*#__PURE__*/React.createElement(\"img\", Object.assign({}, attributes, {\n            src: src,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 11\n            }\n          }));\n        }\n\n      default:\n        return next();\n    }\n  };\n\n  const renderMark = (props, editor, next) => {\n    const {\n      children,\n      mark,\n      attributes\n    } = props;\n\n    switch (mark.type) {\n      case \"bold\":\n        return /*#__PURE__*/React.createElement(\"strong\", Object.assign({}, attributes, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 16\n          }\n        }), children);\n\n      case \"code\":\n        return /*#__PURE__*/React.createElement(\"code\", Object.assign({}, attributes, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 16\n          }\n        }), children);\n\n      case \"italic\":\n        return /*#__PURE__*/React.createElement(\"em\", Object.assign({}, attributes, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 16\n          }\n        }), children);\n\n      case \"underlined\":\n        return /*#__PURE__*/React.createElement(\"u\", Object.assign({}, attributes, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 16\n          }\n        }), children);\n\n      default:\n        return next();\n    }\n  };\n\n  const onKeyDown = (event, editor, next) => {\n    let mark;\n\n    if (isBoldHotkey(event)) {\n      mark = \"bold\";\n    } else if (isItalicHotkey(event)) {\n      mark = \"italic\";\n    } else if (isUnderlinedHotkey(event)) {\n      mark = \"underlined\";\n    } else if (isCodeHotkey(event)) {\n      mark = \"code\";\n    } else {\n      return next();\n    }\n\n    event.preventDefault();\n    editor.toggleMark(mark);\n  };\n\n  const onClickMark = (event, type) => {\n    event.preventDefault();\n    ref.current.toggleMark(type);\n  };\n\n  const onClickImage = event => {\n    event.preventDefault();\n    const src = window.prompt(\"enter the URL of the image:\");\n    if (!src) return;\n    ref.current.command(insertImage, src);\n  };\n\n  const onClickBlock = (event, type) => {\n    event.preventDefault();\n    const editor = ref.current;\n    const value = editor.value;\n    const document = value.document; // Handle everything but list buttons.\n\n    if (type !== \"bulleted-list\" && type !== \"numbered-list\") {\n      const isActive = hasBlock(type);\n      const isList = hasBlock(\"list-item\");\n\n      if (isList) {\n        editor.setBlocks(isActive ? DEFAULT_NODE : type).unwrapBlock(\"bulleted-list\").unwrapBlock(\"numbered-list\");\n      } else {\n        editor.setBlocks(isActive ? DEFAULT_NODE : type);\n      }\n    } else {\n      // Handle the extra wrapping required for list buttons.\n      const isList = hasBlock(\"list-item\");\n      const isType = value.blocks.some(block => {\n        return !!document.getClosest(block.key, parent => parent.type === type);\n      });\n\n      if (isList && isType) {\n        editor.setBlocks(DEFAULT_NODE).unwrapBlock(\"bulleted-list\").unwrapBlock(\"numbered-list\");\n      } else if (isList) {\n        editor.unwrapBlock(type === \"bulleted-list\" ? \"numbered-list\" : \"bulleted-list\").wrapBlock(type);\n      } else {\n        editor.setBlocks(\"list-item\").wrapBlock(type);\n      }\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"overarching\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(FormatToolbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 7\n    }\n  }, renderMarkButton(\"bold\", \"fas fa-bold\"), renderMarkButton(\"italic\", \"fas fa-italic\"), renderMarkButton(\"underlined\", \"fas fa-underline\"), renderMarkButton(\"code\", \"fas fa-code\"), renderBlockButton(\"heading-one\", \"fas fa-heading\"), renderBlockButton(\"heading-two\", \"fas fa-heading\"), renderBlockButton(\"block-quote\", \"fas fa-quote-right\"), renderBlockButton(\"numbered-list\", \"fas fa-list-ol\"), renderBlockButton(\"bulleted-list\", \"fas fa-list-ul\"), renderImageButton(\"fas fa-image\")), /*#__PURE__*/React.createElement(Editor, {\n    ref: ref,\n    className: styles[\"Editor\"],\n    value: value,\n    onChange: opts => setValue(opts.value),\n    onKeyDown: onKeyDown,\n    renderMark: renderMark,\n    renderBlock: renderBlock,\n    schema: schema,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default TextEditor;","map":{"version":3,"sources":["/home/sajalrs/ReactProgramming/article_podcast_website/client/src/components/TextEditor/TextEditor.js"],"names":["React","useState","useRef","Editor","Value","styles","FormatToolbar","isKeyHotkey","imageExtensions","isUrl","initialValue","fromJSON","document","nodes","object","type","leaves","text","TextEditor","value","setValue","ref","DEFAULT_NODE","isBoldHotkey","isItalicHotkey","isUnderlinedHotkey","isCodeHotkey","hasMark","activeMarks","some","node","hasBlock","blocks","isImage","url","includes","getExtension","URL","pathname","split","pop","insertImage","editor","src","target","select","insertBlock","data","schema","last","normalize","code","child","paragraph","Block","create","insertNodeByKey","key","size","image","isVoid","renderMarkButton","icon","isActive","event","onClickMark","renderImageButton","onClickImage","renderBlockButton","parent","getParent","first","onClickBlock","renderBlock","props","next","attributes","children","get","renderMark","mark","onKeyDown","preventDefault","toggleMark","current","window","prompt","command","isList","setBlocks","unwrapBlock","isType","block","getClosest","wrapBlock","opts"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from \"react\";\nimport { Editor } from \"slate-react\";\nimport { Value } from \"slate\";\nimport styles from \"./TextEditor.module.css\";\nimport FormatToolbar from \"./FormatToolbar\";\nimport { isKeyHotkey } from \"is-hotkey\";\nimport imageExtensions from 'image-extensions'\nimport isUrl from 'is-url'\n\nconst initialValue = Value.fromJSON({\n  document: {\n    nodes: [\n      {\n        object: \"block\",\n        type: \"paragraph\",\n        nodes: [\n          {\n            object: \"text\",\n            leaves: [\n              {\n                text: \"My first paragraph\",\n              },\n            ],\n          },\n        ],\n      },\n    ],\n  },\n});\n\nconst TextEditor = () => {\n  const [value, setValue] = useState(initialValue);\n  const ref = useRef();\n  const DEFAULT_NODE = 'paragraph'\n  const isBoldHotkey = isKeyHotkey(\"mod+b\");\n  const isItalicHotkey = isKeyHotkey(\"mod+i\");\n  const isUnderlinedHotkey = isKeyHotkey(\"mod+u\");\n  const isCodeHotkey = isKeyHotkey(\"mod+`\");\n\n  const hasMark = (type) => {\n    return value.activeMarks.some((node) => node.type === type);\n  };\n\n const hasBlock = type => {\n    return value.blocks.some(node => node.type === type)\n  }\n\n  const isImage = (url) => {\n    return imageExtensions.includes(getExtension(url));\n  }\n\n  const getExtension = (url) => {\n      return new URL(url).pathname.split('.').pop;\n  }\n\n  const insertImage = (editor, src, target) => {\n    if(target){\n        editor.select(target)\n    }\n\n    editor.insertBlock({\n        type: 'image',\n        data: {src},\n    })\n  } \n\n  const schema = {\n    document: {\n      last: { type: 'paragraph' },\n      normalize: (editor, { code, node, child }) => {\n        switch (code) {\n          case 'last_child_type_invalid': {\n            const paragraph = Block.create('paragraph')\n            return editor.insertNodeByKey(node.key, node.nodes.size, paragraph)\n          }\n        }\n      },\n    },\n    blocks: {\n      image: {\n        isVoid: true,\n      },\n    },\n  }\n  \n\n  const renderMarkButton = (type, icon) => {\n    const isActive = hasMark(type);\n    return (\n      <button\n        active={isActive}\n        onPointerDown={(event) => onClickMark(event, type)}\n      >\n        <i className={icon} />\n      </button>\n    );\n  };\n\n  const renderImageButton = (icon) => {\n      return(\n        <button\n        onPointerDown={onClickImage}\n      >\n        <i className={icon} />\n      </button>\n      )\n  }\n\n  const renderBlockButton = (type, icon) => {\n    let isActive = hasBlock(type);\n    if ([\"numbered-list\", \"bulleted-list\"].includes(type)) {\n      const { document, blocks } = value;\n\n      if (blocks.size > 0) {\n        const parent = document.getParent(blocks.first().key);\n        isActive = hasBlock(\"list-item\") && parent && parent.type === type;\n      }\n    }\n\n    return (\n      <button\n        active={isActive}\n        onPointerDown={(event) => onClickBlock(event, type)}\n      >\n        <i className={icon}></i>\n      </button>\n    );\n  };\n\n  const renderBlock = (props, editor, next) => {\n    const { attributes, children, node } = props;\n\n    switch (node.type) {\n      case \"block-quote\":\n        return <blockquote {...attributes}>{children}</blockquote>;\n      case \"bulleted-list\":\n        return <ul {...attributes}>{children}</ul>;\n      case \"heading-one\":\n        return <h1 {...attributes}>{children}</h1>;\n      case \"heading-two\":\n        return <h2 {...attributes}>{children}</h2>;\n      case \"list-item\":\n        return <li {...attributes}>{children}</li>;\n      case \"numbered-list\":\n        return <ol {...attributes}>{children}</ol>;\n      case \"image\": {\n        const src = node.data.get('src')\n        return (\n          <img\n            {...attributes}\n            src={src}\n          />\n        )\n      }\n      default:\n        return next();\n    }\n  };\n\n  const renderMark = (props, editor, next) => {\n    const { children, mark, attributes } = props;\n\n    switch (mark.type) {\n      case \"bold\":\n        return <strong {...attributes}>{children}</strong>;\n      case \"code\":\n        return <code {...attributes}>{children}</code>;\n      case \"italic\":\n        return <em {...attributes}>{children}</em>;\n      case \"underlined\":\n        return <u {...attributes}>{children}</u>;\n      default:\n        return next();\n    }\n  };\n\n  const onKeyDown = (event, editor, next) => {\n    let mark;\n\n    if (isBoldHotkey(event)) {\n      mark = \"bold\";\n    } else if (isItalicHotkey(event)) {\n      mark = \"italic\";\n    } else if (isUnderlinedHotkey(event)) {\n      mark = \"underlined\";\n    } else if (isCodeHotkey(event)) {\n      mark = \"code\";\n    } else {\n      return next();\n    }\n\n    event.preventDefault();\n    editor.toggleMark(mark);\n  };\n\n  const onClickMark = (event, type) => {\n    event.preventDefault();\n    ref.current.toggleMark(type);\n  };\n\n  const onClickImage = event => {\n      event.preventDefault();\n      const src = window.prompt(\"enter the URL of the image:\");\n      if(!src) return\n      ref.current.command(insertImage, src)\n  }\n\n  const onClickBlock = (event, type) => {\n    event.preventDefault();\n\n    const editor = ref.current;\n    const value = editor.value;\n    const document = value.document;\n\n    // Handle everything but list buttons.\n    if (type !== \"bulleted-list\" && type !== \"numbered-list\") {\n      const isActive = hasBlock(type);\n      const isList = hasBlock(\"list-item\");\n\n      if (isList) {\n        editor\n          .setBlocks(isActive ? DEFAULT_NODE : type)\n          .unwrapBlock(\"bulleted-list\")\n          .unwrapBlock(\"numbered-list\");\n      } else {\n        editor.setBlocks(isActive ? DEFAULT_NODE : type);\n      }\n    } else {\n      // Handle the extra wrapping required for list buttons.\n      const isList = hasBlock(\"list-item\");\n      const isType = value.blocks.some((block) => {\n        return !!document.getClosest(\n          block.key,\n          (parent) => parent.type === type\n        );\n      });\n\n      if (isList && isType) {\n        editor\n          .setBlocks(DEFAULT_NODE)\n          .unwrapBlock(\"bulleted-list\")\n          .unwrapBlock(\"numbered-list\");\n      } else if (isList) {\n        editor\n          .unwrapBlock(\n            type === \"bulleted-list\" ? \"numbered-list\" : \"bulleted-list\"\n          )\n          .wrapBlock(type);\n      } else {\n        editor.setBlocks(\"list-item\").wrapBlock(type);\n      }\n    }\n  };\n\n  return (\n    <div className={styles[\"overarching\"]}>\n      <FormatToolbar>\n        {renderMarkButton(\"bold\", \"fas fa-bold\")}\n        {renderMarkButton(\"italic\", \"fas fa-italic\")}\n        {renderMarkButton(\"underlined\", \"fas fa-underline\")}\n        {renderMarkButton(\"code\", \"fas fa-code\")}\n        {renderBlockButton(\"heading-one\", \"fas fa-heading\")}\n        {renderBlockButton(\"heading-two\", \"fas fa-heading\")}\n        {renderBlockButton(\"block-quote\", \"fas fa-quote-right\")}\n        {renderBlockButton(\"numbered-list\", \"fas fa-list-ol\")}\n        {renderBlockButton(\"bulleted-list\", \"fas fa-list-ul\")}\n        {renderImageButton(\"fas fa-image\")}\n      </FormatToolbar>\n      <Editor\n        ref={ref}\n        className={styles[\"Editor\"]}\n        value={value}\n        onChange={(opts) => setValue(opts.value)}\n        onKeyDown={onKeyDown}\n        renderMark={renderMark}\n        renderBlock={renderBlock}\n        schema={schema}\n      />\n    </div>\n  );\n};\n\n\n\nexport default TextEditor;\n"]},"metadata":{},"sourceType":"module"}