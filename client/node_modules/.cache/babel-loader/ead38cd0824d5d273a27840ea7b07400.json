{"ast":null,"code":"var _jsxFileName = \"/home/sajalrs/ReactProgramming/article_podcast_website/client/src/components/AudioPlayer/AudioPlayer.js\";\nimport React, { useState, useRef, useEffect, forwardRef } from \"react\";\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setAudioPlayerIsPlaying, setAudioPlayerCurrentTime, setAudioPlayerSelected } from '../../redux/actions';\nimport styles from \"./AudioPlayer.module.css\";\nconst AudioPlayer = forwardRef((props, ref) => {\n  const podcasts = useSelector(state => state.audioPlayer.podcasts); //selected refers to the currently playing audio track.\n  //It is global set to allow clicks and links to change tracks\n\n  const selected = useSelector(state => state.audioPlayer.selected); //audioPLayerRef is initialized to an html5 audio element in the\n  //App.js file and the reference is stored in the global redux\n  //store. This was done for the player to hold its data between\n  //page redirects.This is supposedly bad as only serializable\n  // data should be kept in store but it does the job for now.\n\n  const audioPlayerRef = useSelector(state => state.audioPlayer.audioPlayerRef);\n  const prevTrack = usePrevious(podcasts[selected]) || {\n    title: \"False Nine Podcast #17 Champions League RO16 first Leg review\",\n    by: \"Ishan Sharma, Susajjan Dhungana and Ojash Dangal\",\n    link: \"https://anchor.fm/s/333e122c/podcast/play/19475297/sponsor/a3205tm/https%3A%2F%2Fd3ctxlq1ktw2nl.cloudfront.net%2Fstaging%2F2020-09-12%2F9ca05751732f6a1351863756bdfb662b.m4a\",\n    date: \"Sat, 12 Sep 2020 08:42:34 GMT\",\n    image: \"https://d3t3ozftmdmh3i.cloudfront.net/production/podcast_uploaded_nologo/8497059/8497059-1599895849523-cbb8b2f53d641.jpg\"\n  };\n  const isPlaying = useSelector(state => state.audioPlayer.isPlaying);\n  const currentTime = useSelector(state => state.audioPlayer.currentTime); //React redux useDispatch() hook\n\n  const dispatch = useDispatch();\n  const wasPlaying = usePrevious(isPlaying); //Don't need setDuration can probably get rid of. If it ain't broke....\n\n  const [duration, setDuration] = useState(2172.892); //seekbar shows the time elapsed in the song\n\n  const seekBarRef = useRef();\n  useEffect(() => {\n    if (audioPlayerRef && isPlaying !== wasPlaying) {\n      if (!isPlaying && audioPlayerRef.current) {\n        audioPlayerRef.current.pause();\n      } else if (isPlaying && !wasPlaying && audioPlayerRef.current) {\n        audioPlayerRef.current.play();\n      }\n    }\n  }, [isPlaying, audioPlayerRef]);\n  useEffect(() => {\n    if (audioPlayerRef && podcasts[selected].title != prevTrack.title) {\n      let track = podcasts[selected] ? podcasts[selected].link : null;\n\n      if (track && audioPlayerRef.current) {\n        if (audioPlayerRef.current.src !== track) {\n          audioPlayerRef.current.src = track;\n          audioPlayerRef.current.play();\n          dispatch(setAudioPlayerIsPlaying(true));\n        }\n      }\n    }\n  }, [audioPlayerRef, podcasts[selected]]);\n  useEffect(() => {\n    if (audioPlayerRef && audioPlayerRef.current) {\n      audioPlayerRef.current.addEventListener(\"timeupdate\", e => {\n        dispatch(setAudioPlayerCurrentTime(e.target.currentTime));\n      });\n    }\n  }, [audioPlayerRef]);\n\n  const handleSliderChange = e => {\n    const time = duration * (e.target.value / 100);\n    audioPlayerRef.current.currentTime = time;\n    dispatch(setAudioPlayerCurrentTime(time));\n  };\n\n  const rewindPodcasts = () => {\n    if (selected === podcasts.length - 1) {\n      dispatch(setAudioPlayerSelected(0));\n    } else {\n      dispatch(setAudioPlayerSelected(selected + 1));\n    }\n  };\n\n  const forwardPodcasts = () => {\n    if (selected === 0) {\n      dispatch(setAudioPlayerSelected(podcasts.length - 1));\n    } else {\n      dispatch(setAudioPlayerSelected(selected - 1));\n    }\n  }; //Useful custom hook which stores the previous value of a\n  //variable\n\n\n  function usePrevious(value) {\n    const ref = useRef();\n    useEffect(() => {\n      ref.current = value;\n    });\n    return ref.current;\n  }\n\n  function getTime(time) {\n    if (!isNaN(time)) {\n      return Math.floor(time / 60) + \":\" + (\"0\" + Math.floor(time % 60)).slice(-2);\n    }\n  }\n\n  const progressDuration = getTime(duration);\n  const progressTime = getTime(currentTime);\n  const progress = 100 / duration * currentTime;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: ref,\n    className: styles[\"audio-player\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: props.isActive ? styles[\"image-container\"] : `${styles[\"image-container\"]} ${styles[\"image-container-inactive\"]}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: styles[\"image\"],\n    src: podcasts[selected].image,\n    loading: \"lazy\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"player\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"minimized\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }\n  }, !props.isActive && /*#__PURE__*/React.createElement(\"div\", {\n    id: styles[\"bars\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 31\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying === \"playing\" ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"title-container\"],\n    onClick: () => props.setActive(!props.isActive),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 11\n    }\n  }, podcasts[selected].title.toUpperCase()), props.isActive ? /*#__PURE__*/React.createElement(\"i\", {\n    onClick: () => props.setActive(false),\n    className: `${styles[\"audio-player-inactive\"]} ${styles[\"fas\"]} ${styles[\"fa-chevron-down\"]} fas fa-chevron-down`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }\n  }) : /*#__PURE__*/React.createElement(\"i\", {\n    onClick: () => props.setActive(true),\n    className: `${styles[\"audio-player-active\"]} ${styles[\"fas\"]} ${styles[\"fa-chevron-up\"]} fas fa-chevron-up`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: props.isActive ? styles[\"image-controls\"] : `${styles[\"image-controls\"]} ${styles[\"image-controls-inactive\"]}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"controls\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    onClick: () => rewindPodcasts(),\n    className: `${styles[\"backward-button\"]} ${styles[\"fas\"]} ${styles[\"fa-step-backward\"]} fas fa-step-backward`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }\n  }), audioPlayerRef && !isPlaying && /*#__PURE__*/React.createElement(\"i\", {\n    onClick: () => {\n      audioPlayerRef.current.play();\n      dispatch(setAudioPlayerIsPlaying(true));\n    },\n    className: `${styles[\"play-button\"]} ${styles[\"far\"]} ${styles[\"fa-play-circle\"]} far fa-play-circle`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 15\n    }\n  }), audioPlayerRef && isPlaying && /*#__PURE__*/React.createElement(\"i\", {\n    //Use effect automatically handles changes in redux\n    //state hook to pause the audio player\n    onClick: () => dispatch(setAudioPlayerIsPlaying(false)),\n    className: `${styles[\"pause-button\"]} ${styles[\"far\"]} ${styles[\"fa-pause-circle\"]} far fa-pause-circle`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"i\", {\n    //On ios devices apparently users must explicitly press\n    //play and audio player can't play through callbacks hence this\n    onClick: () => {\n      audioPlayerRef.current.play();\n      forwardPodcasts();\n    },\n    className: `${styles[\"forward-button\"]} ${styles[\"fas\"]} ${styles[\"fa-step-forward\"]} fas fa-step-forward`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"progress-bar\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 11\n    }\n  }, progressTime, \" \", /*#__PURE__*/React.createElement(\"input\", {\n    ref: seekBarRef,\n    type: \"range\",\n    className: styles[\"progress-bar-slider\"],\n    onChange: handleSliderChange,\n    value: progress,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 13\n    }\n  }), \" \", progressDuration))));\n});\nexport default AudioPlayer;","map":{"version":3,"sources":["/home/sajalrs/ReactProgramming/article_podcast_website/client/src/components/AudioPlayer/AudioPlayer.js"],"names":["React","useState","useRef","useEffect","forwardRef","useSelector","useDispatch","setAudioPlayerIsPlaying","setAudioPlayerCurrentTime","setAudioPlayerSelected","styles","AudioPlayer","props","ref","podcasts","state","audioPlayer","selected","audioPlayerRef","prevTrack","usePrevious","title","by","link","date","image","isPlaying","currentTime","dispatch","wasPlaying","duration","setDuration","seekBarRef","current","pause","play","track","src","addEventListener","e","target","handleSliderChange","time","value","rewindPodcasts","length","forwardPodcasts","getTime","isNaN","Math","floor","slice","progressDuration","progressTime","progress","isActive","setActive","toUpperCase"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,MAA1B,EAAkCC,SAAlC,EAA6CC,UAA7C,QAA+D,OAA/D;AACA,SAAQC,WAAR,EAAqBC,WAArB,QAAuC,aAAvC;AACA,SAAQC,uBAAR,EAAiCC,yBAAjC,EAA4DC,sBAA5D,QAAyF,qBAAzF;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,MAAMC,WAAW,GAAGP,UAAU,CAAC,CAACQ,KAAD,EAAQC,GAAR,KAAgB;AAC7C,QAAMC,QAAQ,GAAGT,WAAW,CAACU,KAAK,IAAIA,KAAK,CAACC,WAAN,CAAkBF,QAA5B,CAA5B,CAD6C,CAE7C;AACA;;AACA,QAAMG,QAAQ,GAAGZ,WAAW,CAACU,KAAK,IAAIA,KAAK,CAACC,WAAN,CAAkBC,QAA5B,CAA5B,CAJ6C,CAM7C;AACA;AACA;AACA;AACA;;AACA,QAAMC,cAAc,GAAGb,WAAW,CAACU,KAAK,IAAIA,KAAK,CAACC,WAAN,CAAkBE,cAA5B,CAAlC;AAEA,QAAMC,SAAS,GAAGC,WAAW,CAC3BN,QAAQ,CAACG,QAAD,CADmB,CAAX,IAEb;AACHI,IAAAA,KAAK,EAAE,+DADJ;AAEHC,IAAAA,EAAE,EAAE,kDAFD;AAGHC,IAAAA,IAAI,EACF,8KAJC;AAKHC,IAAAA,IAAI,EAAE,+BALH;AAMHC,IAAAA,KAAK,EACH;AAPC,GAFL;AAYA,QAAMC,SAAS,GAAGrB,WAAW,CAACU,KAAK,IAAIA,KAAK,CAACC,WAAN,CAAkBU,SAA5B,CAA7B;AACA,QAAMC,WAAW,GAAGtB,WAAW,CAACU,KAAK,IAAIA,KAAK,CAACC,WAAN,CAAkBW,WAA5B,CAA/B,CA1B6C,CA4B7C;;AACA,QAAMC,QAAQ,GAAGtB,WAAW,EAA5B;AACA,QAAMuB,UAAU,GAAGT,WAAW,CAACM,SAAD,CAA9B,CA9B6C,CAgC7C;;AACA,QAAM,CAACI,QAAD,EAAWC,WAAX,IAA0B9B,QAAQ,CAAC,QAAD,CAAxC,CAjC6C,CAmC7C;;AACA,QAAM+B,UAAU,GAAG9B,MAAM,EAAzB;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIe,cAAc,IAAIQ,SAAS,KAAKG,UAApC,EAAgD;AAC9C,UAAI,CAACH,SAAD,IAAcR,cAAc,CAACe,OAAjC,EAA0C;AACxCf,QAAAA,cAAc,CAACe,OAAf,CAAuBC,KAAvB;AACD,OAFD,MAEO,IAAIR,SAAS,IAAI,CAACG,UAAd,IAA4BX,cAAc,CAACe,OAA/C,EAAwD;AAC7Df,QAAAA,cAAc,CAACe,OAAf,CAAuBE,IAAvB;AACD;AACF;AACF,GARQ,EAQN,CAACT,SAAD,EAAYR,cAAZ,CARM,CAAT;AAWAf,EAAAA,SAAS,CAAC,MAAM;AACd,QACEe,cAAc,IAAIJ,QAAQ,CAACG,QAAD,CAAR,CAAmBI,KAAnB,IAA4BF,SAAS,CAACE,KAD1D,EAEE;AACA,UAAIe,KAAK,GAAGtB,QAAQ,CAACG,QAAD,CAAR,GACRH,QAAQ,CAACG,QAAD,CAAR,CAAmBM,IADX,GAER,IAFJ;;AAGA,UAAIa,KAAK,IAAIlB,cAAc,CAACe,OAA5B,EAAqC;AACnC,YAAIf,cAAc,CAACe,OAAf,CAAuBI,GAAvB,KAA+BD,KAAnC,EAA0C;AACxClB,UAAAA,cAAc,CAACe,OAAf,CAAuBI,GAAvB,GAA6BD,KAA7B;AACAlB,UAAAA,cAAc,CAACe,OAAf,CAAuBE,IAAvB;AACAP,UAAAA,QAAQ,CAACrB,uBAAuB,CAAC,IAAD,CAAxB,CAAR;AACD;AACF;AACF;AACF,GAfQ,EAeN,CAACW,cAAD,EAAiBJ,QAAQ,CAACG,QAAD,CAAzB,CAfM,CAAT;AAiBAd,EAAAA,SAAS,CAAC,MAAM;AAAC,QAAGe,cAAc,IAAIA,cAAc,CAACe,OAApC,EAA4C;AAC3Df,MAAAA,cAAc,CAACe,OAAf,CAAuBK,gBAAvB,CAAwC,YAAxC,EAAuDC,CAAD,IAAO;AAC3DX,QAAAA,QAAQ,CAACpB,yBAAyB,CAAC+B,CAAC,CAACC,MAAF,CAASb,WAAV,CAA1B,CAAR;AACD,OAFD;AAGA;AACD,GALQ,EAKN,CAACT,cAAD,CALM,CAAT;;AAOA,QAAMuB,kBAAkB,GAAIF,CAAD,IAAO;AAChC,UAAMG,IAAI,GAAGZ,QAAQ,IAAIS,CAAC,CAACC,MAAF,CAASG,KAAT,GAAiB,GAArB,CAArB;AACAzB,IAAAA,cAAc,CAACe,OAAf,CAAuBN,WAAvB,GAAqCe,IAArC;AACAd,IAAAA,QAAQ,CAACpB,yBAAyB,CAACkC,IAAD,CAA1B,CAAR;AACD,GAJD;;AAQA,QAAME,cAAc,GAAG,MAAM;AAC3B,QAAI3B,QAAQ,KAAKH,QAAQ,CAAC+B,MAAT,GAAkB,CAAnC,EAAsC;AACpCjB,MAAAA,QAAQ,CAACnB,sBAAsB,CAAC,CAAD,CAAvB,CAAR;AACD,KAFD,MAEO;AACLmB,MAAAA,QAAQ,CAACnB,sBAAsB,CAACQ,QAAQ,GAAC,CAAV,CAAvB,CAAR;AACD;AACF,GAND;;AAQA,QAAM6B,eAAe,GAAG,MAAM;AAC5B,QAAI7B,QAAQ,KAAK,CAAjB,EAAoB;AAClBW,MAAAA,QAAQ,CAACnB,sBAAsB,CAACK,QAAQ,CAAC+B,MAAT,GAAgB,CAAjB,CAAvB,CAAR;AAED,KAHD,MAGO;AACLjB,MAAAA,QAAQ,CAACnB,sBAAsB,CAACQ,QAAQ,GAAC,CAAV,CAAvB,CAAR;AACD;AACF,GAPD,CAzF6C,CAkG7C;AACA;;;AACA,WAASG,WAAT,CAAqBuB,KAArB,EAA4B;AAC1B,UAAM9B,GAAG,GAAGX,MAAM,EAAlB;AACAC,IAAAA,SAAS,CAAC,MAAM;AACdU,MAAAA,GAAG,CAACoB,OAAJ,GAAcU,KAAd;AACD,KAFQ,CAAT;AAGA,WAAO9B,GAAG,CAACoB,OAAX;AACD;;AAED,WAASc,OAAT,CAAiBL,IAAjB,EAAuB;AACrB,QAAI,CAACM,KAAK,CAACN,IAAD,CAAV,EAAkB;AAChB,aACEO,IAAI,CAACC,KAAL,CAAWR,IAAI,GAAG,EAAlB,IAAwB,GAAxB,GAA8B,CAAC,MAAMO,IAAI,CAACC,KAAL,CAAWR,IAAI,GAAG,EAAlB,CAAP,EAA8BS,KAA9B,CAAoC,CAAC,CAArC,CADhC;AAGD;AACF;;AACD,QAAMC,gBAAgB,GAAGL,OAAO,CAACjB,QAAD,CAAhC;AACA,QAAMuB,YAAY,GAAGN,OAAO,CAACpB,WAAD,CAA5B;AACA,QAAM2B,QAAQ,GAAI,MAAMxB,QAAP,GAAmBH,WAApC;AACA,sBACE;AAAK,IAAA,GAAG,EAAEd,GAAV;AAAe,IAAA,SAAS,EAAEH,MAAM,CAAC,cAAD,CAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,SAAS,EACPE,KAAK,CAAC2C,QAAN,GACI7C,MAAM,CAAC,iBAAD,CADV,GAEK,GAAEA,MAAM,CAAC,iBAAD,CAAoB,IAAGA,MAAM,CAAC,0BAAD,CAA6B,EAJ3E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAOE;AACE,IAAA,SAAS,EAAEA,MAAM,CAAC,OAAD,CADnB;AAEE,IAAA,GAAG,EACFI,QAAQ,CAACG,QAAD,CAAR,CACIQ,KAJP;AAME,IAAA,OAAO,EAAC,MANV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAPF,CADF,eAiBE;AAAK,IAAA,SAAS,EAAEf,MAAM,CAAC,QAAD,CAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAEA,MAAM,CAAC,WAAD,CAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,CAACE,KAAK,CAAC2C,QAAP,iBAAmB;AAAK,IAAA,EAAE,EAAE7C,MAAM,CAAC,MAAD,CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAMpB;AAAK,IAAA,SAAS,EAAEgB,SAAS,GAAGhB,MAAM,CAAC,KAAD,CAAT,GAAmBA,MAAM,CAAC,YAAD,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANoB,eAOlB;AAAK,IAAA,SAAS,EAAEgB,SAAS,GAAGhB,MAAM,CAAC,KAAD,CAAT,GAAmBA,MAAM,CAAC,YAAD,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAPkB,eAQlB;AAAK,IAAA,SAAS,EAAEgB,SAAS,KAAK,SAAd,GAA0BhB,MAAM,CAAC,KAAD,CAAhC,GAA0CA,MAAM,CAAC,YAAD,CAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IARkB,eAUlB;AAAK,IAAA,SAAS,EAAEgB,SAAS,GAAGhB,MAAM,CAAC,KAAD,CAAT,GAAmBA,MAAM,CAAC,YAAD,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAVkB,eAWlB;AAAK,IAAA,SAAS,EAAEgB,SAAS,GAAGhB,MAAM,CAAC,KAAD,CAAT,GAAmBA,MAAM,CAAC,YAAD,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAXkB,eAYlB;AAAK,IAAA,SAAS,EAAEgB,SAAS,GAAGhB,MAAM,CAAC,KAAD,CAAT,GAAmBA,MAAM,CAAC,YAAD,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAZkB,eAalB;AAAK,IAAA,SAAS,EAAEgB,SAAS,GAAGhB,MAAM,CAAC,KAAD,CAAT,GAAmBA,MAAM,CAAC,YAAD,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAbkB,eAclB;AAAK,IAAA,SAAS,EAAEgB,SAAS,GAAGhB,MAAM,CAAC,KAAD,CAAT,GAAmBA,MAAM,CAAC,YAAD,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAdkB,eAelB;AAAK,IAAA,SAAS,EAAEgB,SAAS,GAAGhB,MAAM,CAAC,KAAD,CAAT,GAAmBA,MAAM,CAAC,YAAD,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAfkB,eAgBlB;AAAK,IAAA,SAAS,EAAEgB,SAAS,GAAGhB,MAAM,CAAC,KAAD,CAAT,GAAmBA,MAAM,CAAC,YAAD,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAhBkB,eAiBlB;AAAK,IAAA,SAAS,EAAEgB,SAAS,GAAGhB,MAAM,CAAC,KAAD,CAAT,GAAmBA,MAAM,CAAC,YAAD,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAjBkB,eAkBlB;AAAK,IAAA,SAAS,EAAEgB,SAAS,GAAGhB,MAAM,CAAC,KAAD,CAAT,GAAmBA,MAAM,CAAC,YAAD,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAlBkB,eAmBlB;AAAK,IAAA,SAAS,EAAEgB,SAAS,GAAGhB,MAAM,CAAC,KAAD,CAAT,GAAmBA,MAAM,CAAC,YAAD,CAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAnBkB,CADtB,eAuBE;AACE,IAAA,SAAS,EAAEA,MAAM,CAAC,iBAAD,CADnB;AAEE,IAAA,OAAO,EAAE,MAAME,KAAK,CAAC4C,SAAN,CAAgB,CAAC5C,KAAK,CAAC2C,QAAvB,CAFjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAIGzC,QAAQ,CAACG,QAAD,CAAR,CAAmBI,KAAnB,CAAyBoC,WAAzB,EAJH,CAvBF,EA+BG7C,KAAK,CAAC2C,QAAN,gBACC;AACE,IAAA,OAAO,EAAE,MAAM3C,KAAK,CAAC4C,SAAN,CAAgB,KAAhB,CADjB;AAEE,IAAA,SAAS,EAAG,GAAE9C,MAAM,CAAC,uBAAD,CAA0B,IAAGA,MAAM,CAAC,KAAD,CAAQ,IAAGA,MAAM,CAAC,iBAAD,CAAoB,sBAF9F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,gBAMC;AACE,IAAA,OAAO,EAAE,MAAME,KAAK,CAAC4C,SAAN,CAAgB,IAAhB,CADjB;AAEE,IAAA,SAAS,EAAG,GAAE9C,MAAM,CAAC,qBAAD,CAAwB,IAAGA,MAAM,CAAC,KAAD,CAAQ,IAAGA,MAAM,CAAC,eAAD,CAAkB,oBAF1F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IArCJ,CADF,eA6CE;AACE,IAAA,SAAS,EACPE,KAAK,CAAC2C,QAAN,GACI7C,MAAM,CAAC,gBAAD,CADV,GAEK,GAAEA,MAAM,CAAC,gBAAD,CAAmB,IAAGA,MAAM,CAAC,yBAAD,CAA4B,EAJzE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAOE;AAAK,IAAA,SAAS,EAAEA,MAAM,CAAC,UAAD,CAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,OAAO,EAAE,MAAMkC,cAAc,EAD/B;AAEE,IAAA,SAAS,EAAG,GAAElC,MAAM,CAAC,iBAAD,CAAoB,IAAGA,MAAM,CAAC,KAAD,CAAQ,IAAGA,MAAM,CAAC,kBAAD,CAAqB,uBAFzF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAKGQ,cAAc,IAAI,CAACQ,SAAnB,iBACC;AACE,IAAA,OAAO,EAAE,MAAM;AAACR,MAAAA,cAAc,CAACe,OAAf,CAAuBE,IAAvB;AAA8BP,MAAAA,QAAQ,CAACrB,uBAAuB,CAAC,IAAD,CAAxB,CAAR;AAAwC,KADxF;AAEE,IAAA,SAAS,EAAG,GAAEG,MAAM,CAAC,aAAD,CAAgB,IAAGA,MAAM,CAAC,KAAD,CAAQ,IAAGA,MAAM,CAAC,gBAAD,CAAmB,qBAFnF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANJ,EAWGQ,cAAc,IAAIQ,SAAlB,iBACC;AACE;AACA;AACA,IAAA,OAAO,EAAE,MAAME,QAAQ,CAACrB,uBAAuB,CAAC,KAAD,CAAxB,CAHzB;AAIE,IAAA,SAAS,EAAG,GAAEG,MAAM,CAAC,cAAD,CAAiB,IAAGA,MAAM,CAAC,KAAD,CAAQ,IAAGA,MAAM,CAAC,iBAAD,CAAoB,sBAJrF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAZJ,eAmBE;AACE;AACA;AACA,IAAA,OAAO,EAAE,MAAM;AAACQ,MAAAA,cAAc,CAACe,OAAf,CAAuBE,IAAvB;AAA8BW,MAAAA,eAAe;AAAG,KAHlE;AAIE,IAAA,SAAS,EAAG,GAAEpC,MAAM,CAAC,gBAAD,CAAmB,IAAGA,MAAM,CAAC,KAAD,CAAQ,IAAGA,MAAM,CAAC,iBAAD,CAAoB,sBAJvF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAnBF,CAPF,eAiCE;AAAK,IAAA,SAAS,EAAEA,MAAM,CAAC,cAAD,CAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG2C,YADH,EACiB,GADjB,eAEE;AACE,IAAA,GAAG,EAAErB,UADP;AAEE,IAAA,IAAI,EAAC,OAFP;AAGE,IAAA,SAAS,EAAEtB,MAAM,CAAC,qBAAD,CAHnB;AAIE,IAAA,QAAQ,EAAE+B,kBAJZ;AAKE,IAAA,KAAK,EAAEa,QALT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,EAQK,GARL,EASGF,gBATH,CAjCF,CA7CF,CAjBF,CADF;AA+GD,CArO6B,CAA9B;AAuOA,eAAezC,WAAf","sourcesContent":["import React, { useState, useRef, useEffect, forwardRef } from \"react\";\nimport {useSelector, useDispatch} from 'react-redux'\nimport {setAudioPlayerIsPlaying, setAudioPlayerCurrentTime, setAudioPlayerSelected} from '../../redux/actions'\nimport styles from \"./AudioPlayer.module.css\";\nconst AudioPlayer = forwardRef((props, ref) => {\n  const podcasts = useSelector(state => state.audioPlayer.podcasts) \n  //selected refers to the currently playing audio track.\n  //It is global set to allow clicks and links to change tracks\n  const selected = useSelector(state => state.audioPlayer.selected)\n  \n  //audioPLayerRef is initialized to an html5 audio element in the\n  //App.js file and the reference is stored in the global redux\n  //store. This was done for the player to hold its data between\n  //page redirects.This is supposedly bad as only serializable\n  // data should be kept in store but it does the job for now.\n  const audioPlayerRef = useSelector(state => state.audioPlayer.audioPlayerRef)\n  \n  const prevTrack = usePrevious(\n    podcasts[selected]\n  ) || {\n    title: \"False Nine Podcast #17 Champions League RO16 first Leg review\",\n    by: \"Ishan Sharma, Susajjan Dhungana and Ojash Dangal\",\n    link:\n      \"https://anchor.fm/s/333e122c/podcast/play/19475297/sponsor/a3205tm/https%3A%2F%2Fd3ctxlq1ktw2nl.cloudfront.net%2Fstaging%2F2020-09-12%2F9ca05751732f6a1351863756bdfb662b.m4a\",\n    date: \"Sat, 12 Sep 2020 08:42:34 GMT\",\n    image:\n      \"https://d3t3ozftmdmh3i.cloudfront.net/production/podcast_uploaded_nologo/8497059/8497059-1599895849523-cbb8b2f53d641.jpg\",\n  };\n\n  const isPlaying = useSelector(state => state.audioPlayer.isPlaying);\n  const currentTime = useSelector(state => state.audioPlayer.currentTime);\n  \n  //React redux useDispatch() hook\n  const dispatch = useDispatch();\n  const wasPlaying = usePrevious(isPlaying);\n\n  //Don't need setDuration can probably get rid of. If it ain't broke....\n  const [duration, setDuration] = useState(2172.892);\n  \n  //seekbar shows the time elapsed in the song\n  const seekBarRef = useRef();\n \n  useEffect(() => {\n    if (audioPlayerRef && isPlaying !== wasPlaying) {\n      if (!isPlaying && audioPlayerRef.current) {\n        audioPlayerRef.current.pause();\n      } else if (isPlaying && !wasPlaying && audioPlayerRef.current) {\n        audioPlayerRef.current.play();\n      }\n    }\n  }, [isPlaying, audioPlayerRef]);\n\n\n  useEffect(() => {\n    if (\n      audioPlayerRef && podcasts[selected].title != prevTrack.title\n    ) {\n      let track = podcasts[selected]\n        ? podcasts[selected].link\n        : null;\n      if (track && audioPlayerRef.current) {\n        if (audioPlayerRef.current.src !== track) {\n          audioPlayerRef.current.src = track;\n          audioPlayerRef.current.play();\n          dispatch(setAudioPlayerIsPlaying(true));\n        }\n      }\n    }\n  }, [audioPlayerRef, podcasts[selected]]);\n\n  useEffect(() => {if(audioPlayerRef && audioPlayerRef.current){\n    audioPlayerRef.current.addEventListener(\"timeupdate\", (e) => {\n      dispatch(setAudioPlayerCurrentTime(e.target.currentTime));\n    });\n   }\n  }, [audioPlayerRef]);\n\n  const handleSliderChange = (e) => {\n    const time = duration * (e.target.value / 100);\n    audioPlayerRef.current.currentTime = time;\n    dispatch(setAudioPlayerCurrentTime(time));\n  };\n\n\n  \n  const rewindPodcasts = () => {\n    if (selected === podcasts.length - 1) {\n      dispatch(setAudioPlayerSelected(0));\n    } else {\n      dispatch(setAudioPlayerSelected(selected+1));\n    }\n  };\n\n  const forwardPodcasts = () => {\n    if (selected === 0) {\n      dispatch(setAudioPlayerSelected(podcasts.length-1));\n\n    } else {\n      dispatch(setAudioPlayerSelected(selected-1))\n    }\n  };\n\n  //Useful custom hook which stores the previous value of a\n  //variable\n  function usePrevious(value) {\n    const ref = useRef();\n    useEffect(() => {\n      ref.current = value;\n    });\n    return ref.current;\n  }\n\n  function getTime(time) {\n    if (!isNaN(time)) {\n      return (\n        Math.floor(time / 60) + \":\" + (\"0\" + Math.floor(time % 60)).slice(-2)\n      );\n    }\n  }\n  const progressDuration = getTime(duration);\n  const progressTime = getTime(currentTime);\n  const progress = (100 / duration) * currentTime;\n  return (\n    <div ref={ref} className={styles[\"audio-player\"]}>\n      <div\n        className={\n          props.isActive\n            ? styles[\"image-container\"]\n            : `${styles[\"image-container\"]} ${styles[\"image-container-inactive\"]}`\n        }\n      >\n        <img\n          className={styles[\"image\"]}\n          src={\n           podcasts[selected]\n              .image\n          }\n          loading=\"lazy\"\n        />\n      </div>\n      <div className={styles[\"player\"]}>\n        <div className={styles[\"minimized\"]}>\n          {!props.isActive && <div id={styles[\"bars\"]}>\n        \n          {/*Animation similar to old windows media player\n          which is displayed when podcast is playing and\n        player is maximized*/}\n          \n          <div className={isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n            <div className={isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n            <div className={isPlaying === \"playing\" ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n\n            <div className={isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n            <div className={isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n            <div className={isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n            <div className={isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n            <div className={isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n            <div className={isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n            <div className={isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n            <div className={isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n            <div className={isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n            <div className={isPlaying ? styles[\"bar\"] : styles[\"bar-paused\"]}></div>\n          </div>}\n\n          <div\n            className={styles[\"title-container\"]}\n            onClick={() => props.setActive(!props.isActive)}\n          >\n            {podcasts[selected].title.toUpperCase()}\n          </div>\n          {/*isActive refers to whether audioplayer is minimized/}\n          {/While minimized only playing animation and title appears*/}\n          {props.isActive ? (\n            <i\n              onClick={() => props.setActive(false)}\n              className={`${styles[\"audio-player-inactive\"]} ${styles[\"fas\"]} ${styles[\"fa-chevron-down\"]} fas fa-chevron-down`}\n            ></i>\n          ) : (\n            <i\n              onClick={() => props.setActive(true)}\n              className={`${styles[\"audio-player-active\"]} ${styles[\"fas\"]} ${styles[\"fa-chevron-up\"]} fas fa-chevron-up`}\n            ></i>\n          )}\n        </div>\n\n        <div\n          className={\n            props.isActive\n              ? styles[\"image-controls\"]\n              : `${styles[\"image-controls\"]} ${styles[\"image-controls-inactive\"]}`\n          }\n        >\n          <div className={styles[\"controls\"]}>\n            <i\n              onClick={() => rewindPodcasts()}\n              className={`${styles[\"backward-button\"]} ${styles[\"fas\"]} ${styles[\"fa-step-backward\"]} fas fa-step-backward`}\n            ></i>\n            {audioPlayerRef && !isPlaying && (\n              <i\n                onClick={() => {audioPlayerRef.current.play();dispatch(setAudioPlayerIsPlaying(true))}}\n                className={`${styles[\"play-button\"]} ${styles[\"far\"]} ${styles[\"fa-play-circle\"]} far fa-play-circle`}\n              ></i>\n            )}\n            {audioPlayerRef && isPlaying && (\n              <i\n                //Use effect automatically handles changes in redux\n                //state hook to pause the audio player\n                onClick={() => dispatch(setAudioPlayerIsPlaying(false))}\n                className={`${styles[\"pause-button\"]} ${styles[\"far\"]} ${styles[\"fa-pause-circle\"]} far fa-pause-circle`}\n              ></i>\n            )}\n            <i\n              //On ios devices apparently users must explicitly press\n              //play and audio player can't play through callbacks hence this\n              onClick={() => {audioPlayerRef.current.play();forwardPodcasts()}}\n              className={`${styles[\"forward-button\"]} ${styles[\"fas\"]} ${styles[\"fa-step-forward\"]} fas fa-step-forward`}\n            ></i>\n          </div>\n          <div className={styles[\"progress-bar\"]}>\n            {progressTime}{\" \"}\n            <input\n              ref={seekBarRef}\n              type=\"range\"\n              className={styles[\"progress-bar-slider\"]}\n              onChange={handleSliderChange}\n              value={progress}\n            />{\" \"}\n            {progressDuration}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n});\n\nexport default AudioPlayer;\n"]},"metadata":{},"sourceType":"module"}