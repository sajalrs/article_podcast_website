{"ast":null,"code":"var _jsxFileName = \"/home/sajalrs/ReactProgramming/article_podcast_website/client/src/pages/Articles/ArticlePage.js\";\nimport React, { useState, useEffect } from \"react\";\nimport LargeCard from \"../../components/Cards/LargeCard/LargeCard.js\";\nimport Page from \"../../components/Page/Page\";\nimport styles from \"../../components/Page/Page.module.css\";\nimport { useParams } from \"react-router-dom\";\nimport Html from \"slate-html-serializer\";\nimport { getRules } from \"../../components/TextEditor/TextEditor\";\nimport CommentBar from \"../../components/Comment/CommentBar\";\nimport axios from \"axios\";\nimport { useSelector } from \"react-redux\";\nimport { Card } from \"../../components/Cards/Card\";\n\nconst ArticlePage = props => {\n  const {\n    id\n  } = useParams();\n  const socket = useSelector(state => state.network.socket);\n  const user = useSelector(state => state.login.user);\n  const [article, setArticle] = useState({\n    title: \"\",\n    author: \"\",\n    date: \"\",\n    images: [],\n    content: `<p></p>`,\n    isApproved: false,\n    comments: []\n  });\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, []);\n  useEffect(() => {\n    const rules = getRules(styles);\n    const html = new Html({\n      rules\n    });\n\n    const getArticle = async () => {\n      const response = await axios.get(`/articles/?${id}`);\n      const body = await response.data;\n      if (response.status !== 200) throw Error(body.message);\n      return body;\n    };\n\n    getArticle().then(res => {\n      setArticle({\n        title: res.title,\n        author: res.author,\n        date: res.date,\n        image: res.image,\n        isApproved: res.isApproved,\n        content: res.content ? html.serialize(res.content) : `<p></p>`,\n        comments: res.comments\n      });\n    }).catch(err => {\n      throw Error(err);\n    });\n\n    if (socket) {\n      socket.on(\"comments changed\", data => {\n        if (data.articleId === id.substring(3)) {\n          getArticle().then(res => {\n            setArticle({\n              title: res.title,\n              author: res.author,\n              date: res.date,\n              image: res.image,\n              isApproved: res.isApproved,\n              content: res.content ? html.serialize(res.content) : `<p></p>`,\n              comments: res.comments\n            });\n          }).catch(err => {\n            throw Error(err);\n          });\n        }\n      });\n    }\n  }, [socket]);\n\n  const postComment = comment => {\n    const toPost = {\n      id: id.substring(3),\n      content: comment\n    };\n    const options = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    axios.post(\"/articles/postcomment\", JSON.stringify(toPost), options).then(res => {\n      alert(\"Comment Posted\");\n    }).catch(err => {\n      if (err.response.status === 401 || err.response.status === 400) {\n        alert(err.response.data.error);\n      } else if (err.response.status !== 200) {\n        throw Error(err);\n      }\n    });\n  };\n\n  const isEditable = user && (user.isModerator || user._id === article.authorId);\n  const isPendingApproval = props.contentType === Card.ContentType[\"article-internal\"] && !article.isApproved;\n  const headline = /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"headline\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(LargeCard, {\n    title: article.title,\n    author: article.author,\n    date: article.date,\n    isApproved: article.isApproved,\n    contentType: Card.ContentType[\"article-internal\"],\n    link: `${id}`,\n    isEditable: user && (user.isModerator || user._id === article.authorId),\n    image: article.image,\n    onClick: () => {},\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }));\n  const contents = /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: article.content\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles[\"main-pane-item\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CommentBar, {\n    postComment: postComment,\n    comments: article.comments,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  })));\n  return /*#__PURE__*/React.createElement(Page // sidebarFixTopOffset={35 + 644}\n  , {\n    sidebarFixTopOffset: 0,\n    headline: headline,\n    mainPane: contents,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 5\n    }\n  });\n};\n\nexport default ArticlePage;","map":{"version":3,"sources":["/home/sajalrs/ReactProgramming/article_podcast_website/client/src/pages/Articles/ArticlePage.js"],"names":["React","useState","useEffect","LargeCard","Page","styles","useParams","Html","getRules","CommentBar","axios","useSelector","Card","ArticlePage","props","id","socket","state","network","user","login","article","setArticle","title","author","date","images","content","isApproved","comments","window","scrollTo","rules","html","getArticle","response","get","body","data","status","Error","message","then","res","image","serialize","catch","err","on","articleId","substring","postComment","comment","toPost","options","headers","post","JSON","stringify","alert","error","isEditable","isModerator","_id","authorId","isPendingApproval","contentType","ContentType","headline","contents","__html"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,SAAP,MAAsB,+CAAtB;AACA,OAAOC,IAAP,MAAiB,4BAAjB;AACA,OAAOC,MAAP,MAAmB,uCAAnB;AACA,SAASC,SAAT,QAA0B,kBAA1B;AACA,OAAOC,IAAP,MAAiB,uBAAjB;AACA,SAASC,QAAT,QAAyB,wCAAzB;AACA,OAAOC,UAAP,MAAuB,qCAAvB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,IAAT,QAAqB,6BAArB;;AACA,MAAMC,WAAW,GAAIC,KAAD,IAAW;AAC7B,QAAM;AAAEC,IAAAA;AAAF,MAAST,SAAS,EAAxB;AACA,QAAMU,MAAM,GAAGL,WAAW,CAAEM,KAAD,IAAWA,KAAK,CAACC,OAAN,CAAcF,MAA1B,CAA1B;AACA,QAAMG,IAAI,GAAGR,WAAW,CAAEM,KAAD,IAAWA,KAAK,CAACG,KAAN,CAAYD,IAAxB,CAAxB;AACA,QAAM,CAACE,OAAD,EAAUC,UAAV,IAAwBrB,QAAQ,CAAC;AACrCsB,IAAAA,KAAK,EAAE,EAD8B;AAErCC,IAAAA,MAAM,EAAE,EAF6B;AAGrCC,IAAAA,IAAI,EAAE,EAH+B;AAIrCC,IAAAA,MAAM,EAAE,EAJ6B;AAKrCC,IAAAA,OAAO,EAAG,SAL2B;AAMrCC,IAAAA,UAAU,EAAE,KANyB;AAOrCC,IAAAA,QAAQ,EAAE;AAP2B,GAAD,CAAtC;AASA3B,EAAAA,SAAS,CAAC,MAAM;AACd4B,IAAAA,MAAM,CAACC,QAAP,CAAgB,CAAhB,EAAmB,CAAnB;AACD,GAFQ,EAEN,EAFM,CAAT;AAGA7B,EAAAA,SAAS,CAAC,MAAM;AACd,UAAM8B,KAAK,GAAGxB,QAAQ,CAACH,MAAD,CAAtB;AACA,UAAM4B,IAAI,GAAG,IAAI1B,IAAJ,CAAS;AAAEyB,MAAAA;AAAF,KAAT,CAAb;;AAEA,UAAME,UAAU,GAAG,YAAY;AAC7B,YAAMC,QAAQ,GAAG,MAAMzB,KAAK,CAAC0B,GAAN,CAAW,cAAarB,EAAG,EAA3B,CAAvB;AACA,YAAMsB,IAAI,GAAG,MAAMF,QAAQ,CAACG,IAA5B;AACA,UAAIH,QAAQ,CAACI,MAAT,KAAoB,GAAxB,EAA6B,MAAMC,KAAK,CAACH,IAAI,CAACI,OAAN,CAAX;AAC7B,aAAOJ,IAAP;AACD,KALD;;AAOAH,IAAAA,UAAU,GACPQ,IADH,CACSC,GAAD,IAAS;AACbrB,MAAAA,UAAU,CAAC;AACTC,QAAAA,KAAK,EAAEoB,GAAG,CAACpB,KADF;AAETC,QAAAA,MAAM,EAAEmB,GAAG,CAACnB,MAFH;AAGTC,QAAAA,IAAI,EAAEkB,GAAG,CAAClB,IAHD;AAITmB,QAAAA,KAAK,EAAED,GAAG,CAACC,KAJF;AAKThB,QAAAA,UAAU,EAAEe,GAAG,CAACf,UALP;AAMTD,QAAAA,OAAO,EAAEgB,GAAG,CAAChB,OAAJ,GAAcM,IAAI,CAACY,SAAL,CAAeF,GAAG,CAAChB,OAAnB,CAAd,GAA6C,SAN7C;AAOTE,QAAAA,QAAQ,EAAEc,GAAG,CAACd;AAPL,OAAD,CAAV;AASD,KAXH,EAYGiB,KAZH,CAYUC,GAAD,IAAS;AACd,YAAMP,KAAK,CAACO,GAAD,CAAX;AACD,KAdH;;AAgBA,QAAI/B,MAAJ,EAAY;AACVA,MAAAA,MAAM,CAACgC,EAAP,CAAU,kBAAV,EAA+BV,IAAD,IAAU;AACtC,YAAIA,IAAI,CAACW,SAAL,KAAmBlC,EAAE,CAACmC,SAAH,CAAa,CAAb,CAAvB,EAAwC;AACtChB,UAAAA,UAAU,GACPQ,IADH,CACSC,GAAD,IAAS;AACbrB,YAAAA,UAAU,CAAC;AACTC,cAAAA,KAAK,EAAEoB,GAAG,CAACpB,KADF;AAETC,cAAAA,MAAM,EAAEmB,GAAG,CAACnB,MAFH;AAGTC,cAAAA,IAAI,EAAEkB,GAAG,CAAClB,IAHD;AAITmB,cAAAA,KAAK,EAAED,GAAG,CAACC,KAJF;AAKThB,cAAAA,UAAU,EAAEe,GAAG,CAACf,UALP;AAMTD,cAAAA,OAAO,EAAEgB,GAAG,CAAChB,OAAJ,GAAcM,IAAI,CAACY,SAAL,CAAeF,GAAG,CAAChB,OAAnB,CAAd,GAA6C,SAN7C;AAOTE,cAAAA,QAAQ,EAAEc,GAAG,CAACd;AAPL,aAAD,CAAV;AASD,WAXH,EAYGiB,KAZH,CAYUC,GAAD,IAAS;AACd,kBAAMP,KAAK,CAACO,GAAD,CAAX;AACD,WAdH;AAeD;AACF,OAlBD;AAmBD;AACF,GAhDQ,EAgDN,CAAC/B,MAAD,CAhDM,CAAT;;AAkDA,QAAMmC,WAAW,GAAIC,OAAD,IAAa;AAC/B,UAAMC,MAAM,GAAG;AAAEtC,MAAAA,EAAE,EAAEA,EAAE,CAACmC,SAAH,CAAa,CAAb,CAAN;AAAuBvB,MAAAA,OAAO,EAAEyB;AAAhC,KAAf;AACA,UAAME,OAAO,GAAG;AACdC,MAAAA,OAAO,EAAE;AAAE,wBAAgB;AAAlB;AADK,KAAhB;AAIA7C,IAAAA,KAAK,CACF8C,IADH,CACQ,uBADR,EACiCC,IAAI,CAACC,SAAL,CAAeL,MAAf,CADjC,EACyDC,OADzD,EAEGZ,IAFH,CAESC,GAAD,IAAS;AACbgB,MAAAA,KAAK,CAAC,gBAAD,CAAL;AACD,KAJH,EAKGb,KALH,CAKUC,GAAD,IAAS;AACd,UAAIA,GAAG,CAACZ,QAAJ,CAAaI,MAAb,KAAwB,GAAxB,IAA+BQ,GAAG,CAACZ,QAAJ,CAAaI,MAAb,KAAwB,GAA3D,EAAgE;AAC9DoB,QAAAA,KAAK,CAACZ,GAAG,CAACZ,QAAJ,CAAaG,IAAb,CAAkBsB,KAAnB,CAAL;AACD,OAFD,MAEO,IAAIb,GAAG,CAACZ,QAAJ,CAAaI,MAAb,KAAwB,GAA5B,EAAiC;AACtC,cAAMC,KAAK,CAACO,GAAD,CAAX;AACD;AACF,KAXH;AAYD,GAlBD;;AAoBA,QAAMc,UAAU,GACd1C,IAAI,KAAKA,IAAI,CAAC2C,WAAL,IAAoB3C,IAAI,CAAC4C,GAAL,KAAa1C,OAAO,CAAC2C,QAA9C,CADN;AAEA,QAAMC,iBAAiB,GACrBnD,KAAK,CAACoD,WAAN,KAAsBtD,IAAI,CAACuD,WAAL,CAAiB,kBAAjB,CAAtB,IACA,CAAC9C,OAAO,CAACO,UAFX;AAIA,QAAMwC,QAAQ,gBACZ;AAAK,IAAA,SAAS,EAAE/D,MAAM,CAAC,UAAD,CAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,SAAD;AACE,IAAA,KAAK,EAAEgB,OAAO,CAACE,KADjB;AAEE,IAAA,MAAM,EAAEF,OAAO,CAACG,MAFlB;AAGE,IAAA,IAAI,EAAEH,OAAO,CAACI,IAHhB;AAIE,IAAA,UAAU,EAAEJ,OAAO,CAACO,UAJtB;AAKE,IAAA,WAAW,EAAEhB,IAAI,CAACuD,WAAL,CAAiB,kBAAjB,CALf;AAME,IAAA,IAAI,EAAG,GAAEpD,EAAG,EANd;AAOE,IAAA,UAAU,EAAEI,IAAI,KAAKA,IAAI,CAAC2C,WAAL,IAAoB3C,IAAI,CAAC4C,GAAL,KAAa1C,OAAO,CAAC2C,QAA9C,CAPlB;AAQE,IAAA,KAAK,EAAE3C,OAAO,CAACuB,KARjB;AASE,IAAA,OAAO,EAAE,MAAM,CAAE,CATnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF;AAgBA,QAAMyB,QAAQ,gBACZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,uBAAuB,EAAE;AAAEC,MAAAA,MAAM,EAAEjD,OAAO,CAACM;AAAlB,KAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAEE;AAAK,IAAA,SAAS,EAAEtB,MAAM,CAAC,gBAAD,CAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,UAAD;AAAY,IAAA,WAAW,EAAE8C,WAAzB;AAAsC,IAAA,QAAQ,EAAE9B,OAAO,CAACQ,QAAxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAFF,CADF;AASA,sBACE,oBAAC,IAAD,CACE;AADF;AAEE,IAAA,mBAAmB,EAAE,CAFvB;AAGE,IAAA,QAAQ,EAAEuC,QAHZ;AAIE,IAAA,QAAQ,EAAEC,QAJZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF;AAQD,CA7HD;;AA+HA,eAAexD,WAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport LargeCard from \"../../components/Cards/LargeCard/LargeCard.js\";\nimport Page from \"../../components/Page/Page\";\nimport styles from \"../../components/Page/Page.module.css\";\nimport { useParams } from \"react-router-dom\";\nimport Html from \"slate-html-serializer\";\nimport { getRules } from \"../../components/TextEditor/TextEditor\";\nimport CommentBar from \"../../components/Comment/CommentBar\";\nimport axios from \"axios\";\nimport { useSelector } from \"react-redux\";\nimport { Card } from \"../../components/Cards/Card\";\nconst ArticlePage = (props) => {\n  const { id } = useParams();\n  const socket = useSelector((state) => state.network.socket);\n  const user = useSelector((state) => state.login.user);\n  const [article, setArticle] = useState({\n    title: \"\",\n    author: \"\",\n    date: \"\",\n    images: [],\n    content: `<p></p>`,\n    isApproved: false,\n    comments: [],\n  });\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, []);\n  useEffect(() => {\n    const rules = getRules(styles);\n    const html = new Html({ rules });\n\n    const getArticle = async () => {\n      const response = await axios.get(`/articles/?${id}`);\n      const body = await response.data;\n      if (response.status !== 200) throw Error(body.message);\n      return body;\n    };\n\n    getArticle()\n      .then((res) => {\n        setArticle({\n          title: res.title,\n          author: res.author,\n          date: res.date,\n          image: res.image,\n          isApproved: res.isApproved,\n          content: res.content ? html.serialize(res.content) : `<p></p>`,\n          comments: res.comments,\n        });\n      })\n      .catch((err) => {\n        throw Error(err);\n      });\n\n    if (socket) {\n      socket.on(\"comments changed\", (data) => {\n        if (data.articleId === id.substring(3)) {\n          getArticle()\n            .then((res) => {\n              setArticle({\n                title: res.title,\n                author: res.author,\n                date: res.date,\n                image: res.image,\n                isApproved: res.isApproved,\n                content: res.content ? html.serialize(res.content) : `<p></p>`,\n                comments: res.comments,\n              });\n            })\n            .catch((err) => {\n              throw Error(err);\n            });\n        }\n      });\n    }\n  }, [socket]);\n\n  const postComment = (comment) => {\n    const toPost = { id: id.substring(3), content: comment };\n    const options = {\n      headers: { \"Content-Type\": \"application/json\" },\n    };\n\n    axios\n      .post(\"/articles/postcomment\", JSON.stringify(toPost), options)\n      .then((res) => {\n        alert(\"Comment Posted\");\n      })\n      .catch((err) => {\n        if (err.response.status === 401 || err.response.status === 400) {\n          alert(err.response.data.error);\n        } else if (err.response.status !== 200) {\n          throw Error(err);\n        }\n      });\n  };\n\n  const isEditable =\n    user && (user.isModerator || user._id === article.authorId);\n  const isPendingApproval =\n    props.contentType === Card.ContentType[\"article-internal\"] &&\n    !article.isApproved;\n\n  const headline = (\n    <div className={styles[\"headline\"]}>\n      <LargeCard\n        title={article.title}\n        author={article.author}\n        date={article.date}\n        isApproved={article.isApproved}\n        contentType={Card.ContentType[\"article-internal\"]}\n        link={`${id}`}\n        isEditable={user && (user.isModerator || user._id === article.authorId)}\n        image={article.image}\n        onClick={() => {}}\n      />\n    </div>\n  );\n\n  const contents = (\n    <div>\n      <div dangerouslySetInnerHTML={{ __html: article.content }}></div>\n      <div className={styles[\"main-pane-item\"]}>\n        <CommentBar postComment={postComment} comments={article.comments} />\n      </div>\n    </div>\n  );\n\n  return (\n    <Page\n      // sidebarFixTopOffset={35 + 644}\n      sidebarFixTopOffset={0}\n      headline={headline}\n      mainPane={contents}\n    />\n  );\n};\n\nexport default ArticlePage;\n"]},"metadata":{},"sourceType":"module"}