{"ast":null,"code":"const jwt = require(\"jsonwebtoken\");\n\nconst verify = handler => async (req, res) => {\n  const token = req.cookies.token;\n  if (!token) return res.status(401).send({\n    error: \"Please Login to Proceed\"\n  });\n\n  try {\n    const verified = jwt.verify(token, process.env.TOKEN_SECRET);\n    req.user = verified;\n  } catch (err) {\n    res.status(400).send({\n      error: \"Invalid Token\"\n    });\n  }\n\n  return handler(req, res);\n};\n\nexport default verify;","map":{"version":3,"sources":["/home/sajalrs/ReactProgramming/article_podcast_website/pages/api/verification/verifyToken.js"],"names":["jwt","require","verify","handler","req","res","token","cookies","status","send","error","verified","process","env","TOKEN_SECRET","user","err"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AAEA,MAAMC,MAAM,GAAIC,OAAD,IAAa,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAC9C,QAAMC,KAAK,GAAGF,GAAG,CAACG,OAAJ,CAAYD,KAA1B;AACA,MAAI,CAACA,KAAL,EAAY,OAAOD,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,IAAAA,KAAK,EAAE;AAAT,GAArB,CAAP;;AACZ,MAAI;AACF,UAAMC,QAAQ,GAAGX,GAAG,CAACE,MAAJ,CAAWI,KAAX,EAAkBM,OAAO,CAACC,GAAR,CAAYC,YAA9B,CAAjB;AACAV,IAAAA,GAAG,CAACW,IAAJ,GAAWJ,QAAX;AACD,GAHD,CAGE,OAAOK,GAAP,EAAY;AACZX,IAAAA,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,KAAK,EAAE;AAAT,KAArB;AACD;;AACD,SAAOP,OAAO,CAACC,GAAD,EAAMC,GAAN,CAAd;AACD,CAVD;;AAYA,eAAeH,MAAf","sourcesContent":["const jwt = require(\"jsonwebtoken\");\n\nconst verify = (handler) => async (req, res) => {\n  const token = req.cookies.token;\n  if (!token) return res.status(401).send({ error: \"Please Login to Proceed\" });\n  try {\n    const verified = jwt.verify(token, process.env.TOKEN_SECRET);\n    req.user = verified;\n  } catch (err) {\n    res.status(400).send({ error: \"Invalid Token\" });\n  }\n  return handler(req, res);\n};\n\nexport default verify;\n\n"]},"metadata":{},"sourceType":"module"}