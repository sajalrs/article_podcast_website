{"ast":null,"code":"const jwt = require(\"jsonwebtoken\");\n\nconst verify = handler => async (req, res) => {\n  const token = req.cookies.token;\n\n  if (!token) {\n    req.isAuth = false;\n    return handler(req, res);\n  }\n\n  try {\n    const verified = jwt.verify(token, process.env.TOKEN_SECRET);\n    req.isAuth = true;\n    req.user = verified;\n  } catch (err) {\n    throw Error(\"Invalid token\");\n  }\n\n  return handler(req, res);\n};\n\nexport default verify;","map":{"version":3,"sources":["/home/sajalrs/ReactProgramming/article_podcast_website/pages/api/verification/verifyTokenGraphql.js"],"names":["jwt","require","verify","handler","req","res","token","cookies","isAuth","verified","process","env","TOKEN_SECRET","user","err","Error"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AAEA,MAAMC,MAAM,GAAIC,OAAD,IAAa,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAC9C,QAAMC,KAAK,GAAGF,GAAG,CAACG,OAAJ,CAAYD,KAA1B;;AACA,MAAI,CAACA,KAAL,EAAY;AACVF,IAAAA,GAAG,CAACI,MAAJ,GAAa,KAAb;AACA,WAAOL,OAAO,CAACC,GAAD,EAAMC,GAAN,CAAd;AACD;;AACD,MAAI;AACF,UAAMI,QAAQ,GAAGT,GAAG,CAACE,MAAJ,CAAWI,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,YAA9B,CAAjB;AACAR,IAAAA,GAAG,CAACI,MAAJ,GAAa,IAAb;AACAJ,IAAAA,GAAG,CAACS,IAAJ,GAAWJ,QAAX;AACD,GAJD,CAIE,OAAOK,GAAP,EAAY;AACZ,UAAMC,KAAK,CAAC,eAAD,CAAX;AACD;;AACD,SAAOZ,OAAO,CAACC,GAAD,EAAMC,GAAN,CAAd;AACD,CAdD;;AAgBA,eAAeH,MAAf","sourcesContent":["const jwt = require(\"jsonwebtoken\");\n\nconst verify = (handler) => async (req, res) => {\n  const token = req.cookies.token;\n  if (!token) {\n    req.isAuth = false;\n    return handler(req, res);\n  }\n  try {\n    const verified = jwt.verify(token, process.env.TOKEN_SECRET);\n    req.isAuth = true;\n    req.user = verified;\n  } catch (err) {\n    throw Error(\"Invalid token\");\n  }\n  return handler(req, res);\n};\n\nexport default verify;\n"]},"metadata":{},"sourceType":"module"}