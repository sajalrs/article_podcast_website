{"ast":null,"code":"const mongoose = require(\"mongoose\");\n\nrequire(\"dotenv/config\");\n\nconst connectDb = handler => async (req, res) => {\n  if (mongoose.connections[0].readyState) return handler(req, res);\n  await mongoose.connect(process.env.MONGO_URL, {\n    useNewUrlParser: true,\n    useFindAndModify: true,\n    useCreateIndex: true\n  });\n  res.setHeader(\"Set-Cookie\", serialize(\"yoyo\", \"yoyo\", {\n    path: \"*\"\n  }, {\n    httpOnly: true\n  }));\n  return handler(req, res);\n};\n\nexport default connectDb;","map":{"version":3,"sources":["/home/sajalrs/ReactProgramming/article_podcast_website/pages/api/middlewares/dbMiddleware.js"],"names":["mongoose","require","connectDb","handler","req","res","connections","readyState","connect","process","env","MONGO_URL","useNewUrlParser","useFindAndModify","useCreateIndex","setHeader","serialize","path","httpOnly"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACAA,OAAO,CAAC,eAAD,CAAP;;AAEA,MAAMC,SAAS,GAAIC,OAAD,IAAa,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjD,MAAIL,QAAQ,CAACM,WAAT,CAAqB,CAArB,EAAwBC,UAA5B,EAAwC,OAAOJ,OAAO,CAACC,GAAD,EAAMC,GAAN,CAAd;AACxC,QAAML,QAAQ,CAACQ,OAAT,CAAiBC,OAAO,CAACC,GAAR,CAAYC,SAA7B,EAAwC;AAC5CC,IAAAA,eAAe,EAAE,IAD2B;AAE5CC,IAAAA,gBAAgB,EAAE,IAF0B;AAG5CC,IAAAA,cAAc,EAAE;AAH4B,GAAxC,CAAN;AAMAT,EAAAA,GAAG,CAACU,SAAJ,CACE,YADF,EAEEC,SAAS,CAAC,MAAD,EAAS,MAAT,EAAiB;AAAEC,IAAAA,IAAI,EAAE;AAAR,GAAjB,EAAgC;AAAEC,IAAAA,QAAQ,EAAE;AAAZ,GAAhC,CAFX;AAKA,SAAOf,OAAO,CAACC,GAAD,EAAMC,GAAN,CAAd;AACD,CAdD;;AAgBA,eAAeH,SAAf","sourcesContent":["const mongoose = require(\"mongoose\");\nrequire(\"dotenv/config\");\n\nconst connectDb = (handler) => async (req, res) => {\n  if (mongoose.connections[0].readyState) return handler(req, res);\n  await mongoose.connect(process.env.MONGO_URL, {\n    useNewUrlParser: true,\n    useFindAndModify: true,\n    useCreateIndex: true,\n  });\n\n  res.setHeader(\n    \"Set-Cookie\",\n    serialize(\"yoyo\", \"yoyo\", { path: \"*\" }, { httpOnly: true })\n  );\n\n  return handler(req, res);\n};\n\nexport default connectDb;\n"]},"metadata":{},"sourceType":"module"}