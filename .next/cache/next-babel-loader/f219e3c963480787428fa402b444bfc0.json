{"ast":null,"code":"const mongoose = require(\"mongoose\");\n\nrequire(\"dotenv/config\");\n\nimport { serialize } from \"cookie\";\n\nconst connectDb = handler => async (req, res) => {\n  if (mongoose.connections[0].readyState) return handler(req, res);\n  await mongoose.connect(process.env.MONGO_URL, {\n    useNewUrlParser: true,\n    useFindAndModify: true,\n    useCreateIndex: true\n  });\n  res.setHeader(\"Set-Cookie\", serialize(\"yoyo\", \"yoyo\", {\n    path: \"*\"\n  }, {\n    httpOnly: true\n  }));\n  return handler(req, res);\n};\n\nexport default connectDb;","map":{"version":3,"sources":["/home/sajalrs/ReactProgramming/article_podcast_website/pages/api/middlewares/dbMiddleware.js"],"names":["mongoose","require","serialize","connectDb","handler","req","res","connections","readyState","connect","process","env","MONGO_URL","useNewUrlParser","useFindAndModify","useCreateIndex","setHeader","path","httpOnly"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACAA,OAAO,CAAC,eAAD,CAAP;;AACA,SAASC,SAAT,QAA0B,QAA1B;;AAEA,MAAMC,SAAS,GAAIC,OAAD,IAAa,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjD,MAAIN,QAAQ,CAACO,WAAT,CAAqB,CAArB,EAAwBC,UAA5B,EAAwC,OAAOJ,OAAO,CAACC,GAAD,EAAMC,GAAN,CAAd;AACxC,QAAMN,QAAQ,CAACS,OAAT,CAAiBC,OAAO,CAACC,GAAR,CAAYC,SAA7B,EAAwC;AAC5CC,IAAAA,eAAe,EAAE,IAD2B;AAE5CC,IAAAA,gBAAgB,EAAE,IAF0B;AAG5CC,IAAAA,cAAc,EAAE;AAH4B,GAAxC,CAAN;AAMAT,EAAAA,GAAG,CAACU,SAAJ,CACE,YADF,EAEEd,SAAS,CAAC,MAAD,EAAS,MAAT,EAAiB;AAAEe,IAAAA,IAAI,EAAE;AAAR,GAAjB,EAAgC;AAAEC,IAAAA,QAAQ,EAAE;AAAZ,GAAhC,CAFX;AAKA,SAAOd,OAAO,CAACC,GAAD,EAAMC,GAAN,CAAd;AACD,CAdD;;AAgBA,eAAeH,SAAf","sourcesContent":["const mongoose = require(\"mongoose\");\nrequire(\"dotenv/config\");\nimport { serialize } from \"cookie\";\n\nconst connectDb = (handler) => async (req, res) => {\n  if (mongoose.connections[0].readyState) return handler(req, res);\n  await mongoose.connect(process.env.MONGO_URL, {\n    useNewUrlParser: true,\n    useFindAndModify: true,\n    useCreateIndex: true,\n  });\n\n  res.setHeader(\n    \"Set-Cookie\",\n    serialize(\"yoyo\", \"yoyo\", { path: \"*\" }, { httpOnly: true })\n  );\n\n  return handler(req, res);\n};\n\nexport default connectDb;\n"]},"metadata":{},"sourceType":"module"}