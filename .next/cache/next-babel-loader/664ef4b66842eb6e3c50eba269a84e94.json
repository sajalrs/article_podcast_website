{"ast":null,"code":"import connectDb from \"../middlewares/dbMiddleware.js\";\n\nconst {\n  messageValidation\n} = require(\"../validation/validation\");\n\nconst mongoose = require(\"mongoose\");\n\nlet Message;\n\ntry {\n  Message = mongoose.model(\"Messages\");\n} catch {\n  Message = require(\"../models/Messages\");\n}\n\nconst handler = async (req, res) => {\n  const {\n    error\n  } = messageValidation(req.body);\n\n  if (error) {\n    const toReturn = error.details[0].message.replace('\"firstName\"', \"First Name\").replace('\"lastName\"', \"Last Name\").replace('\"email\"', \"Email\").replace('\"subject\"', \"Subject\");\n    return res.status(400).send({\n      error: toReturn\n    });\n  }\n\n  const message = new Message({\n    firstName: req.body.firstName,\n    lastName: req.body.lastName,\n    email: req.body.email,\n    subject: req.body.subject,\n    content: req.body.content\n  });\n  await message.save((err, data) => {\n    if (err) {\n      res.send(err);\n    } else {\n      res.json({\n        data\n      });\n    }\n  });\n};\n\nexport default connectDb(handler);","map":{"version":3,"sources":["/home/sajalrs/ReactProgramming/article_podcast_website/pages/api/messages/create.js"],"names":["connectDb","messageValidation","require","mongoose","Message","model","handler","req","res","error","body","toReturn","details","message","replace","status","send","firstName","lastName","email","subject","content","save","err","data","json"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,gCAAtB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAwBC,OAAO,CAAC,0BAAD,CAArC;;AACA,MAAMC,QAAQ,GAAGD,OAAO,CAAC,UAAD,CAAxB;;AACA,IAAIE,OAAJ;;AACA,IAAI;AACFA,EAAAA,OAAO,GAAGD,QAAQ,CAACE,KAAT,CAAe,UAAf,CAAV;AACD,CAFD,CAEE,MAAM;AACND,EAAAA,OAAO,GAAGF,OAAO,CAAC,oBAAD,CAAjB;AACD;;AAED,MAAMI,OAAO,GAAG,OAAOC,GAAP,EAAWC,GAAX,KAAmB;AAC/B,QAAM;AAAEC,IAAAA;AAAF,MAAYR,iBAAiB,CAACM,GAAG,CAACG,IAAL,CAAnC;;AACA,MAAID,KAAJ,EAAW;AACT,UAAME,QAAQ,GAAGF,KAAK,CAACG,OAAN,CAAc,CAAd,EAAiBC,OAAjB,CACdC,OADc,CACN,aADM,EACS,YADT,EAEdA,OAFc,CAEN,YAFM,EAEQ,WAFR,EAGdA,OAHc,CAGN,SAHM,EAGK,OAHL,EAIdA,OAJc,CAIN,WAJM,EAIO,SAJP,CAAjB;AAKA,WAAON,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEP,MAAAA,KAAK,EAAEE;AAAT,KAArB,CAAP;AACD;;AAED,QAAME,OAAO,GAAG,IAAIT,OAAJ,CAAY;AAC1Ba,IAAAA,SAAS,EAAEV,GAAG,CAACG,IAAJ,CAASO,SADM;AAE1BC,IAAAA,QAAQ,EAAEX,GAAG,CAACG,IAAJ,CAASQ,QAFO;AAG1BC,IAAAA,KAAK,EAAEZ,GAAG,CAACG,IAAJ,CAASS,KAHU;AAI1BC,IAAAA,OAAO,EAAEb,GAAG,CAACG,IAAJ,CAASU,OAJQ;AAK1BC,IAAAA,OAAO,EAAEd,GAAG,CAACG,IAAJ,CAASW;AALQ,GAAZ,CAAhB;AAQA,QAAMR,OAAO,CAACS,IAAR,CAAa,CAACC,GAAD,EAAMC,IAAN,KAAe;AAChC,QAAID,GAAJ,EAAS;AACPf,MAAAA,GAAG,CAACQ,IAAJ,CAASO,GAAT;AACD,KAFD,MAEO;AACLf,MAAAA,GAAG,CAACiB,IAAJ,CAAS;AAAED,QAAAA;AAAF,OAAT;AACD;AACF,GANK,CAAN;AAOH,CA1BD;;AA4BA,eAAexB,SAAS,CAACM,OAAD,CAAxB","sourcesContent":["import connectDb from \"../middlewares/dbMiddleware.js\";\nconst { messageValidation } = require(\"../validation/validation\");\nconst mongoose = require(\"mongoose\");\nlet Message;\ntry {\n  Message = mongoose.model(\"Messages\");\n} catch {\n  Message = require(\"../models/Messages\");\n}\n\nconst handler = async (req,res) => {\n    const { error } = messageValidation(req.body);\n    if (error) {\n      const toReturn = error.details[0].message\n        .replace('\"firstName\"', \"First Name\")\n        .replace('\"lastName\"', \"Last Name\")\n        .replace('\"email\"', \"Email\")\n        .replace('\"subject\"', \"Subject\");\n      return res.status(400).send({ error: toReturn });\n    }\n  \n    const message = new Message({\n      firstName: req.body.firstName,\n      lastName: req.body.lastName,\n      email: req.body.email,\n      subject: req.body.subject,\n      content: req.body.content,\n    });\n  \n    await message.save((err, data) => {\n      if (err) {\n        res.send(err);\n      } else {\n        res.json({ data });\n      }\n    });\n}\n\nexport default connectDb(handler);"]},"metadata":{},"sourceType":"module"}